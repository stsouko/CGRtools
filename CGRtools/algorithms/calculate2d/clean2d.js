!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.$=e():t.$=e()}(self,(function(){return(()=>{var t={261:(t,e,i)=>{const r=i(881),n=i(19),s=i(479);var o=!("undefined"==typeof window||!window.document||!window.document.createElement),a={Version:"1.0.0"};a.Drawer=r,a.Parser=n,a.SvgDrawer=s,a.clean=function(t){return t.replace(/[^A-Za-z0-9@\.\+\-\?!\(\)\[\]\{\}/\\=#\$:\*]/g,"")},a.apply=function(t,e="canvas[data-smiles]",i="light",n=null){let s=new r(t),o=document.querySelectorAll(e);for(var h=0;h<o.length;h++){let t=o[h];a.parse(t.getAttribute("data-smiles"),(function(e){s.draw(e,t,i,!1)}),(function(t){n&&n(t)}))}},a.parse=function(t,e,i){try{e&&e(n.parse(t))}catch(t){i&&i(t)}},o&&(window.SmilesDrawer=a),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(t){if(null==this)throw new TypeError("this is null or not defined");for(var e=Object(this),i=e.length>>>0,r=arguments[1],n=r>>0,s=n<0?Math.max(i+n,0):Math.min(n,i),o=arguments[2],a=void 0===o?i:o>>0,h=a<0?Math.max(i+a,0):Math.min(a,i);s<h;)e[s]=t,s++;return e}}),t.exports=a},348:t=>{class e{static clone(t){let i=Array.isArray(t)?Array():{};for(let r in t){let n=t[r];"function"==typeof n.clone?i[r]=n.clone():i[r]="object"==typeof n?e.clone(n):n}return i}static equals(t,e){if(t.length!==e.length)return!1;let i=t.slice().sort(),r=e.slice().sort();for(var n=0;n<i.length;n++)if(i[n]!==r[n])return!1;return!0}static print(t){if(0==t.length)return"";let e="(";for(let i=0;i<t.length;i++)e+=t[i].id?t[i].id+", ":t[i]+", ";return e=e.substring(0,e.length-2),e+")"}static each(t,e){for(let i=0;i<t.length;i++)e(t[i])}static get(t,e,i){for(let r=0;r<t.length;r++)if(t[r][e]==i)return t[r]}static contains(t,e){if(e.property||e.func){if(e.func){for(let i=0;i<t.length;i++)if(e.func(t[i]))return!0}else for(let i=0;i<t.length;i++)if(t[i][e.property]==e.value)return!0}else for(let i=0;i<t.length;i++)if(t[i]==e.value)return!0;return!1}static intersection(t,e){let i=new Array;for(let r=0;r<t.length;r++)for(let n=0;n<e.length;n++)t[r]===e[n]&&i.push(t[r]);return i}static unique(t){let e={};return t.filter((function(t){return void 0===e[t]&&(e[t]=!0)}))}static count(t,e){let i=0;for(let r=0;r<t.length;r++)t[r]===e&&i++;return i}static toggle(t,e){let i=Array(),r=!1;for(let n=0;n<t.length;n++)t[n]!==e?i.push(t[n]):r=!0;return r||i.push(e),i}static remove(t,e){let i=Array();for(let r=0;r<t.length;r++)t[r]!==e&&i.push(t[r]);return i}static removeUnique(t,e){let i=t.indexOf(e);return i>-1&&t.splice(i,1),t}static removeAll(t,e){return t.filter((function(t){return-1===e.indexOf(t)}))}static merge(t,e){let i=new Array(t.length+e.length);for(let e=0;e<t.length;e++)i[e]=t[e];for(let r=0;r<e.length;r++)i[t.length+r]=e[r];return i}static containsAll(t,e){let i=0;for(let r=0;r<t.length;r++)for(let n=0;n<e.length;n++)t[r]===e[n]&&i++;return i===e.length}static sortByAtomicNumberDesc(t){let e=t.map((function(t,e){return{index:e,value:t.atomicNumber.split(".").map(Number)}}));return e.sort((function(t,e){let i=Math.min(e.value.length,t.value.length),r=0;for(;r<i&&e.value[r]===t.value[r];)r++;return r===i?e.value.length-t.value.length:e.value[r]-t.value[r]})),e.map((function(e){return t[e.index]}))}static deepCopy(t){let i=Array();for(let r=0;r<t.length;r++){let n=t[r];i[r]=n instanceof Array?e.deepCopy(n):n}return i}}t.exports=e},427:(t,e,i)=>{const r=i(348);i(843),i(421);class n{constructor(t,e="-"){this.element=1===t.length?t.toUpperCase():t,this.drawExplicit=!1,this.ringbonds=Array(),this.rings=Array(),this.bondType=e,this.branchBond=null,this.isBridge=!1,this.isBridgeNode=!1,this.originalRings=Array(),this.bridgedRing=null,this.anchoredRings=Array(),this.bracket=null,this.plane=0,this.attachedPseudoElements={},this.hasAttachedPseudoElements=!1,this.isDrawn=!0,this.isConnectedToRing=!1,this.neighbouringElements=Array(),this.isPartOfAromaticRing=t!==this.element,this.bondCount=0,this.chirality="",this.isStereoCenter=!1,this.priority=0,this.mainChain=!1,this.hydrogenDirection="down",this.subtreeDepth=1,this.hasHydrogen=!1}addNeighbouringElement(t){this.neighbouringElements.push(t)}attachPseudoElement(t,e,i=0,r=0){null===i&&(i=0),null===r&&(r=0);let n=i+t+r;this.attachedPseudoElements[n]?this.attachedPseudoElements[n].count+=1:this.attachedPseudoElements[n]={element:t,count:1,hydrogenCount:i,previousElement:e,charge:r},this.hasAttachedPseudoElements=!0}getAttachedPseudoElements(){let t={},e=this;return Object.keys(this.attachedPseudoElements).sort().forEach((function(i){t[i]=e.attachedPseudoElements[i]})),t}getAttachedPseudoElementsCount(){return Object.keys(this.attachedPseudoElements).length}isHeteroAtom(){return"C"!==this.element&&"H"!==this.element}addAnchoredRing(t){r.contains(this.anchoredRings,{value:t})||this.anchoredRings.push(t)}getRingbondCount(){return this.ringbonds.length}backupRings(){this.originalRings=Array(this.rings.length);for(let t=0;t<this.rings.length;t++)this.originalRings[t]=this.rings[t]}restoreRings(){this.rings=Array(this.originalRings.length);for(let t=0;t<this.originalRings.length;t++)this.rings[t]=this.originalRings[t]}haveCommonRingbond(t,e){for(let i=0;i<t.ringbonds.length;i++)for(let r=0;r<e.ringbonds.length;r++)if(t.ringbonds[i].id==e.ringbonds[r].id)return!0;return!1}neighbouringElementsEqual(t){if(t.length!==this.neighbouringElements.length)return!1;t.sort(),this.neighbouringElements.sort();for(var e=0;e<this.neighbouringElements.length;e++)if(t[e]!==this.neighbouringElements[e])return!1;return!0}getAtomicNumber(){return n.atomicNumbers[this.element]}getMaxBonds(){return n.maxBonds[this.element]}static get maxBonds(){return{H:1,C:4,N:3,O:2,P:3,S:2,B:3,F:1,I:1,Cl:1,Br:1}}static get atomicNumbers(){return{H:1,He:2,Li:3,Be:4,B:5,b:5,C:6,c:6,N:7,n:7,O:8,o:8,F:9,Ne:10,Na:11,Mg:12,Al:13,Si:14,P:15,p:15,S:16,s:16,Cl:17,Ar:18,K:19,Ca:20,Sc:21,Ti:22,V:23,Cr:24,Mn:25,Fe:26,Co:27,Ni:28,Cu:29,Zn:30,Ga:31,Ge:32,As:33,Se:34,Br:35,Kr:36,Rb:37,Sr:38,Y:39,Zr:40,Nb:41,Mo:42,Tc:43,Ru:44,Rh:45,Pd:46,Ag:47,Cd:48,In:49,Sn:50,Sb:51,Te:52,I:53,Xe:54,Cs:55,Ba:56,La:57,Ce:58,Pr:59,Nd:60,Pm:61,Sm:62,Eu:63,Gd:64,Tb:65,Dy:66,Ho:67,Er:68,Tm:69,Yb:70,Lu:71,Hf:72,Ta:73,W:74,Re:75,Os:76,Ir:77,Pt:78,Au:79,Hg:80,Tl:81,Pb:82,Bi:83,Po:84,At:85,Rn:86,Fr:87,Ra:88,Ac:89,Th:90,Pa:91,U:92,Np:93,Pu:94,Am:95,Cm:96,Bk:97,Cf:98,Es:99,Fm:100,Md:101,No:102,Lr:103,Rf:104,Db:105,Sg:106,Bh:107,Hs:108,Mt:109,Ds:110,Rg:111,Cn:112,Uut:113,Uuq:114,Uup:115,Uuh:116,Uus:117,Uuo:118}}static get mass(){return{H:1,He:2,Li:3,Be:4,B:5,b:5,C:6,c:6,N:7,n:7,O:8,o:8,F:9,Ne:10,Na:11,Mg:12,Al:13,Si:14,P:15,p:15,S:16,s:16,Cl:17,Ar:18,K:19,Ca:20,Sc:21,Ti:22,V:23,Cr:24,Mn:25,Fe:26,Co:27,Ni:28,Cu:29,Zn:30,Ga:31,Ge:32,As:33,Se:34,Br:35,Kr:36,Rb:37,Sr:38,Y:39,Zr:40,Nb:41,Mo:42,Tc:43,Ru:44,Rh:45,Pd:46,Ag:47,Cd:48,In:49,Sn:50,Sb:51,Te:52,I:53,Xe:54,Cs:55,Ba:56,La:57,Ce:58,Pr:59,Nd:60,Pm:61,Sm:62,Eu:63,Gd:64,Tb:65,Dy:66,Ho:67,Er:68,Tm:69,Yb:70,Lu:71,Hf:72,Ta:73,W:74,Re:75,Os:76,Ir:77,Pt:78,Au:79,Hg:80,Tl:81,Pb:82,Bi:83,Po:84,At:85,Rn:86,Fr:87,Ra:88,Ac:89,Th:90,Pa:91,U:92,Np:93,Pu:94,Am:95,Cm:96,Bk:97,Cf:98,Es:99,Fm:100,Md:101,No:102,Lr:103,Rf:104,Db:105,Sg:106,Bh:107,Hs:108,Mt:109,Ds:110,Rg:111,Cn:112,Uut:113,Uuq:114,Uup:115,Uuh:116,Uus:117,Uuo:118}}}t.exports=n},841:(t,e,i)=>{const r=i(474),n=i(614),{getChargeText:s}=(i(929),i(843),i(421),i(537));t.exports=class{constructor(t,e,i){this.canvas="string"==typeof t||t instanceof String?document.getElementById(t):t,this.ctx=this.canvas.getContext("2d"),this.themeManager=e,this.opts=i,this.drawingWidth=0,this.drawingHeight=0,this.offsetX=0,this.offsetY=0,this.fontLarge=this.opts.fontSizeLarge+"pt Helvetica, Arial, sans-serif",this.fontSmall=this.opts.fontSizeSmall+"pt Helvetica, Arial, sans-serif",this.updateSize(this.opts.width,this.opts.height),this.ctx.font=this.fontLarge,this.hydrogenWidth=this.ctx.measureText("H").width,this.halfHydrogenWidth=this.hydrogenWidth/2,this.halfBondThickness=this.opts.bondThickness/2}updateSize(t,e){this.devicePixelRatio=window.devicePixelRatio||1,this.backingStoreRatio=this.ctx.webkitBackingStorePixelRatio||this.ctx.mozBackingStorePixelRatio||this.ctx.msBackingStorePixelRatio||this.ctx.oBackingStorePixelRatio||this.ctx.backingStorePixelRatio||1,this.ratio=this.devicePixelRatio/this.backingStoreRatio,1!==this.ratio?(this.canvas.width=t*this.ratio,this.canvas.height=e*this.ratio,this.canvas.style.width=t+"px",this.canvas.style.height=e+"px",this.ctx.setTransform(this.ratio,0,0,this.ratio,0,0)):(this.canvas.width=t*this.ratio,this.canvas.height=e*this.ratio)}setTheme(t){this.colors=t}scale(t){let e=-Number.MAX_VALUE,i=-Number.MAX_VALUE,r=Number.MAX_VALUE,n=Number.MAX_VALUE;for(var s=0;s<t.length;s++){if(!t[s].value.isDrawn)continue;let o=t[s].position;e<o.x&&(e=o.x),i<o.y&&(i=o.y),r>o.x&&(r=o.x),n>o.y&&(n=o.y)}var o=this.opts.padding;e+=o,i+=o,r-=o,n-=o,this.drawingWidth=e-r,this.drawingHeight=i-n;var a=this.canvas.offsetWidth/this.drawingWidth,h=this.canvas.offsetHeight/this.drawingHeight,l=a<h?a:h;this.ctx.scale(l,l),this.offsetX=-r,this.offsetY=-n,a<h?this.offsetY+=this.canvas.offsetHeight/(2*l)-this.drawingHeight/2:this.offsetX+=this.canvas.offsetWidth/(2*l)-this.drawingWidth/2}reset(){this.ctx.setTransform(1,0,0,1,0,0)}getColor(t){return(t=t.toUpperCase())in this.colors?this.colors[t]:this.colors.C}drawCircle(t,e,i,n,s=!0,o=!1,a=""){let h=this.ctx,l=this.offsetX,g=this.offsetY;h.save(),h.lineWidth=1.5,h.beginPath(),h.arc(t+l,e+g,i,0,r.twoPI,!0),h.closePath(),o?(s?(h.fillStyle="#f00",h.fill()):(h.strokeStyle="#f00",h.stroke()),this.drawDebugText(t,e,a)):s?(h.fillStyle=n,h.fill()):(h.strokeStyle=n,h.stroke()),h.restore()}drawLine(t,e=!1,i=1){let r=this.ctx,n=this.offsetX,s=this.offsetY,o=t.clone().shorten(4),a=o.getLeftVector().clone(),h=o.getRightVector().clone();a.x+=n,a.y+=s,h.x+=n,h.y+=s,e||(r.save(),r.globalCompositeOperation="destination-out",r.beginPath(),r.moveTo(a.x,a.y),r.lineTo(h.x,h.y),r.lineCap="round",r.lineWidth=this.opts.bondThickness+1.2,r.strokeStyle=this.themeManager.getColor("BACKGROUND"),r.stroke(),r.globalCompositeOperation="source-over",r.restore()),a=t.getLeftVector().clone(),h=t.getRightVector().clone(),a.x+=n,a.y+=s,h.x+=n,h.y+=s,r.save(),r.beginPath(),r.moveTo(a.x,a.y),r.lineTo(h.x,h.y),r.lineCap="round",r.lineWidth=this.opts.bondThickness;let l=this.ctx.createLinearGradient(a.x,a.y,h.x,h.y);l.addColorStop(.4,this.themeManager.getColor(t.getLeftElement())||this.themeManager.getColor("C")),l.addColorStop(.6,this.themeManager.getColor(t.getRightElement())||this.themeManager.getColor("C")),e&&(r.setLineDash([1,1.5]),r.lineWidth=this.opts.bondThickness/1.5),i<1&&(r.globalAlpha=i),r.strokeStyle=l,r.stroke(),r.restore()}drawWedge(t,e=1){if(isNaN(t.from.x)||isNaN(t.from.y)||isNaN(t.to.x)||isNaN(t.to.y))return;let i=this.ctx,r=this.offsetX,s=this.offsetY,o=t.clone().shorten(5),a=o.getLeftVector().clone(),h=o.getRightVector().clone();a.x+=r,a.y+=s,h.x+=r,h.y+=s,a=t.getLeftVector().clone(),h=t.getRightVector().clone(),a.x+=r,a.y+=s,h.x+=r,h.y+=s,i.save();let l=n.normals(a,h);l[0].normalize(),l[1].normalize();let g=a,d=h;t.getRightChiral()&&(g=h,d=a);let u=n.add(g,n.multiplyScalar(l[0],this.halfBondThickness)),c=n.add(d,n.multiplyScalar(l[0],1.5+this.halfBondThickness)),p=n.add(d,n.multiplyScalar(l[1],1.5+this.halfBondThickness)),f=n.add(g,n.multiplyScalar(l[1],this.halfBondThickness));i.beginPath(),i.moveTo(u.x,u.y),i.lineTo(c.x,c.y),i.lineTo(p.x,p.y),i.lineTo(f.x,f.y);let v=this.ctx.createRadialGradient(h.x,h.y,this.opts.bondLength,h.x,h.y,0);v.addColorStop(.4,this.themeManager.getColor(t.getLeftElement())||this.themeManager.getColor("C")),v.addColorStop(.6,this.themeManager.getColor(t.getRightElement())||this.themeManager.getColor("C")),i.fillStyle=v,i.fill(),i.restore()}drawDashedWedge(t){if(isNaN(t.from.x)||isNaN(t.from.y)||isNaN(t.to.x)||isNaN(t.to.y))return;let e=this.ctx,i=this.offsetX,r=this.offsetY,s=t.getLeftVector().clone(),o=t.getRightVector().clone();s.x+=i,s.y+=r,o.x+=i,o.y+=r,e.save();let a=n.normals(s,o);a[0].normalize(),a[1].normalize();let h,l,g,d,u=t.getRightChiral(),c=t.clone();u?(h=o,l=s,c.shortenRight(1),g=c.getRightVector().clone(),d=c.getLeftVector().clone()):(h=s,l=o,c.shortenLeft(1),g=c.getLeftVector().clone(),d=c.getRightVector().clone()),g.x+=i,g.y+=r,d.x+=i,d.y+=r;let p=n.subtract(l,h).normalize();e.strokeStyle=this.themeManager.getColor("C"),e.lineCap="round",e.lineWidth=this.opts.bondThickness,e.beginPath();let f=t.getLength(),v=1.25/(f/(3*this.opts.bondThickness)),m=!1;for(var b=0;b<1;b+=v){let i=n.multiplyScalar(p,b*f),r=n.add(h,i),s=1.5*b,o=n.multiplyScalar(a[0],s);!m&&b>.5&&(e.stroke(),e.beginPath(),e.strokeStyle=this.themeManager.getColor(t.getRightElement())||this.themeManager.getColor("C"),m=!0),r.subtract(o),e.moveTo(r.x,r.y),r.add(n.multiplyScalar(o,2)),e.lineTo(r.x,r.y)}e.stroke(),e.restore()}drawDebugText(t,e,i){let r=this.ctx;r.save(),r.font="5px Droid Sans, sans-serif",r.textAlign="start",r.textBaseline="top",r.fillStyle="#ff0000",r.fillText(i,t+this.offsetX,e+this.offsetY),r.restore()}drawBall(t,e,i){let n=this.ctx;n.save(),n.beginPath(),n.arc(t+this.offsetX,e+this.offsetY,this.opts.bondLength/4.5,0,r.twoPI,!1),n.fillStyle=this.themeManager.getColor(i),n.fill(),n.restore()}drawPoint(t,e,i){let n=this.ctx,s=this.offsetX,o=this.offsetY;n.save(),n.globalCompositeOperation="destination-out",n.beginPath(),n.arc(t+s,e+o,1.5,0,r.twoPI,!0),n.closePath(),n.fill(),n.globalCompositeOperation="source-over",n.beginPath(),n.arc(t+this.offsetX,e+this.offsetY,.75,0,r.twoPI,!1),n.fillStyle=this.themeManager.getColor(i),n.fill(),n.restore()}drawText(t,e,i,n,o,a,h,l,g={}){let d=this.ctx,u=this.offsetX,c=this.offsetY;d.save(),d.textAlign="start",d.textBaseline="alphabetic";let p="",f=0;h&&(p=s(h),d.font=this.fontSmall,f=d.measureText(p).width);let v="0",m=0;l>0&&(v=l.toString(),d.font=this.fontSmall,m=d.measureText(v).width),1===h&&"N"===i&&g.hasOwnProperty("0O")&&g.hasOwnProperty("0O-1")&&(g={"0O":{element:"O",count:2,hydrogenCount:0,previousElement:"C",charge:""}},h=0),d.font=this.fontLarge,d.fillStyle=this.themeManager.getColor("BACKGROUND");let b=d.measureText(i);b.totalWidth=b.width+f,b.height=parseInt(this.fontLarge,10);let y=b.width>this.opts.fontSizeLarge?b.width:this.opts.fontSizeLarge;y/=1.5,d.globalCompositeOperation="destination-out",d.beginPath(),d.arc(t+u,e+c,y,0,r.twoPI,!0),d.closePath(),d.fill(),d.globalCompositeOperation="source-over";let S=-b.width/2,w=-b.width/2;d.fillStyle=this.themeManager.getColor(i),d.fillText(i,t+u+S,e+this.opts.halfFontSizeLarge+c),S+=b.width,h&&(d.font=this.fontSmall,d.fillText(p,t+u+S,e-this.opts.fifthFontSizeSmall+c),S+=f),l>0&&(d.font=this.fontSmall,d.fillText(v,t+u+w-m,e-this.opts.fifthFontSizeSmall+c),w-=m),d.font=this.fontLarge;let x=0,A=0;if(1===n){let i=t+u,r=e+c+this.opts.halfFontSizeLarge;x=this.hydrogenWidth,w-=x,"left"===o?i+=w:"right"===o||"up"===o&&a||"down"===o&&a?i+=S:"up"!==o||a?"down"!==o||a||(r+=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,i-=this.halfHydrogenWidth):(r-=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,i-=this.halfHydrogenWidth),d.fillText("H",i,r),S+=x}else if(n>1){let i=t+u,r=e+c+this.opts.halfFontSizeLarge;x=this.hydrogenWidth,d.font=this.fontSmall,A=d.measureText(n).width,w-=x+A,"left"===o?i+=w:"right"===o||"up"===o&&a||"down"===o&&a?i+=S:"up"!==o||a?"down"!==o||a||(r+=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,i-=this.halfHydrogenWidth):(r-=this.opts.fontSizeLarge+this.opts.quarterFontSizeLarge,i-=this.halfHydrogenWidth),d.font=this.fontLarge,d.fillText("H",i,r),d.font=this.fontSmall,d.fillText(n,i+this.halfHydrogenWidth+A,r+this.opts.fifthFontSizeSmall),S+=x+this.halfHydrogenWidth+A}for(let i in g){if(!g.hasOwnProperty(i))continue;let r=0,n=0,a=g[i].element,h=g[i].count,l=g[i].hydrogenCount,p=g[i].charge;d.font=this.fontLarge,h>1&&l>0&&(r=d.measureText("(").width,n=d.measureText(")").width);let f=d.measureText(a).width,v=0,m="",b=0;x=0,l>0&&(x=this.hydrogenWidth),d.font=this.fontSmall,h>1&&(v=d.measureText(h).width),0!==p&&(m=s(p),b=d.measureText(m).width),A=0,l>1&&(A=d.measureText(l).width),d.font=this.fontLarge;let y=t+u,C=e+c+this.opts.halfFontSizeLarge;d.fillStyle=this.themeManager.getColor(a),h>0&&(w-=v),h>1&&l>0&&("left"===o?(w-=n,d.fillText(")",y+w,C)):(d.fillText("(",y+S,C),S+=r)),"left"===o?(w-=f,d.fillText(a,y+w,C)):(d.fillText(a,y+S,C),S+=f),l>0&&("left"===o?(w-=x+A,d.fillText("H",y+w,C),l>1&&(d.font=this.fontSmall,d.fillText(l,y+w+x,C+this.opts.fifthFontSizeSmall))):(d.fillText("H",y+S,C),S+=x,l>1&&(d.font=this.fontSmall,d.fillText(l,y+S,C+this.opts.fifthFontSizeSmall),S+=A))),d.font=this.fontLarge,h>1&&l>0&&("left"===o?(w-=r,d.fillText("(",y+w,C)):(d.fillText(")",y+S,C),S+=n)),d.font=this.fontSmall,h>1&&("left"===o?d.fillText(h,y+w+r+n+x+A+f,C+this.opts.fifthFontSizeSmall):(d.fillText(h,y+S,C+this.opts.fifthFontSizeSmall),S+=v)),0!==p&&("left"===o?d.fillText(m,y+w+r+n+x+A+f,e-this.opts.fifthFontSizeSmall+c):(d.fillText(m,y+S,e-this.opts.fifthFontSizeSmall+c),S+=b))}d.restore()}getChargeText(t){return 1===t?"+":2===t?"2+":-1===t?"-":-2===t?"2-":""}drawDebugPoint(t,e,i="",r="#f00"){this.drawCircle(t,e,2,r,!0,!0,i)}drawAromaticityRing(t){let e=this.ctx,i=r.apothemFromSideLength(this.opts.bondLength,t.getSize());e.save(),e.strokeStyle=this.themeManager.getColor("C"),e.lineWidth=this.opts.bondThickness,e.beginPath(),e.arc(t.center.x+this.offsetX,t.center.y+this.offsetY,i-this.opts.bondSpacing,0,2*Math.PI,!0),e.closePath(),e.stroke(),e.restore()}clear(){this.ctx.clearRect(0,0,this.canvas.offsetWidth,this.canvas.offsetHeight)}}},881:(t,e,i)=>{const r=i(474),n=i(348),s=i(614),o=i(929),a=(i(843),i(826)),h=i(427),l=i(421),g=i(333),d=i(841),u=i(707),c=i(473),p=i(654);t.exports=class{constructor(t){this.graph=null,this.doubleBondConfigCount=0,this.doubleBondConfig=null,this.ringIdCounter=0,this.ringConnectionIdCounter=0,this.canvasWrapper=null,this.totalOverlapScore=0,this.defaultOptions={width:500,height:500,bondThickness:.6,bondLength:15,shortBondLength:.85,bondSpacing:.18*15,atomVisualization:"default",isomeric:!0,debug:!1,terminalCarbons:!1,explicitHydrogens:!0,overlapSensitivity:.42,overlapResolutionIterations:1,compactDrawing:!0,fontSizeLarge:5,fontSizeSmall:3,padding:20,experimentalSSSR:!1,kkThreshold:.1,kkInnerThreshold:.1,kkMaxIteration:2e4,kkMaxInnerIteration:50,kkMaxEnergy:1e9,themes:{dark:{C:"#fff",O:"#e74c3c",N:"#3498db",F:"#27ae60",CL:"#16a085",BR:"#d35400",I:"#8e44ad",P:"#d35400",S:"#f1c40f",B:"#e67e22",SI:"#e67e22",H:"#fff",BACKGROUND:"#141414"},light:{C:"#222",O:"#e74c3c",N:"#3498db",F:"#27ae60",CL:"#16a085",BR:"#d35400",I:"#8e44ad",P:"#d35400",S:"#f1c40f",B:"#e67e22",SI:"#e67e22",H:"#222",BACKGROUND:"#fff"}}},this.opts=this.extend(!0,this.defaultOptions,t),this.opts.halfBondSpacing=this.opts.bondSpacing/2,this.opts.bondLengthSq=this.opts.bondLength*this.opts.bondLength,this.opts.halfFontSizeLarge=this.opts.fontSizeLarge/2,this.opts.quarterFontSizeLarge=this.opts.fontSizeLarge/4,this.opts.fifthFontSizeSmall=this.opts.fontSizeSmall/5,this.theme=this.opts.themes.dark}extend(){let t=this,e={},i=!1,r=0,n=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(i=arguments[0],r++);let s=function(r){for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(i&&"[object Object]"===Object.prototype.toString.call(r[n])?e[n]=t.extend(!0,e[n],r[n]):e[n]=r[n])};for(;r<n;r++)s(arguments[r]);return e}draw(t,e,i="light",r=!1){this.initDraw(t,i,r),this.infoOnly||(this.themeManager=new p(this.opts.themes,i),this.canvasWrapper=new d(e,this.themeManager,this.opts)),r||(this.processGraph(),this.canvasWrapper.scale(this.graph.vertices),this.drawEdges(this.opts.debug),this.drawVertices(this.opts.debug),this.canvasWrapper.reset(),this.opts.debug&&(console.log(this.graph),console.log(this.rings),console.log(this.ringConnections)))}edgeRingCount(t){let e=this.graph.edges[t],i=this.graph.vertices[e.sourceId],r=this.graph.vertices[e.targetId];return Math.min(i.value.rings.length,r.value.rings.length)}getBridgedRings(){let t=Array();for(var e=0;e<this.rings.length;e++)this.rings[e].isBridged&&t.push(this.rings[e]);return t}getFusedRings(){let t=Array();for(var e=0;e<this.rings.length;e++)this.rings[e].isFused&&t.push(this.rings[e]);return t}getSpiros(){let t=Array();for(var e=0;e<this.rings.length;e++)this.rings[e].isSpiro&&t.push(this.rings[e]);return t}printRingInfo(){let t="";for(var e=0;e<this.rings.length;e++){const i=this.rings[e];t+=i.id+";",t+=i.members.length+";",t+=i.neighbours.length+";",t+=i.isSpiro?"true;":"false;",t+=i.isFused?"true;":"false;",t+=i.isBridged?"true;":"false;",t+=i.rings.length+";",t+="\n"}return t}rotateDrawing(){let t=0,e=0,i=0;for(var r=0;r<this.graph.vertices.length;r++){let s=this.graph.vertices[r];if(s.value.isDrawn)for(var n=r+1;n<this.graph.vertices.length;n++){let o=this.graph.vertices[n];if(!o.value.isDrawn)continue;let a=s.position.distanceSq(o.position);a>i&&(i=a,t=r,e=n)}}let o=-s.subtract(this.graph.vertices[t].position,this.graph.vertices[e].position).angle();if(!isNaN(o)){let t=o%.523599;for(t<.2617995?o-=t:o+=.523599-t,r=0;r<this.graph.vertices.length;r++)r!==e&&this.graph.vertices[r].position.rotateAround(o,this.graph.vertices[e].position);for(r=0;r<this.rings.length;r++)this.rings[r].center.rotateAround(o,this.graph.vertices[e].position)}}getTotalOverlapScore(){return this.totalOverlapScore}getRingCount(){return this.rings.length}hasBridgedRing(){return this.bridgedRing}getHeavyAtomCount(){let t=0;for(var e=0;e<this.graph.vertices.length;e++)"H"!==this.graph.vertices[e].value.element&&t++;return t}getMolecularFormula(){let t="",e=new Map;for(var i=0;i<this.graph.vertices.length;i++){let t=this.graph.vertices[i].value;if(e.has(t.element)?e.set(t.element,e.get(t.element)+1):e.set(t.element,1),t.bracket&&!t.bracket.chirality&&(e.has("H")?e.set("H",e.get("H")+t.bracket.hcount):e.set("H",t.bracket.hcount)),!t.bracket){let i=h.maxBonds[t.element]-t.bondCount;t.isPartOfAromaticRing&&i--,e.has("H")?e.set("H",e.get("H")+i):e.set("H",i)}}if(e.has("C")){let i=e.get("C");t+="C"+(i>1?i:""),e.delete("C")}if(e.has("H")){let i=e.get("H");t+="H"+(i>1?i:""),e.delete("H")}return Object.keys(h.atomicNumbers).sort().map((i=>{if(e.has(i)){let r=e.get(i);t+=i+(r>1?r:"")}})),t}getRingbondType(t,e){if(t.value.getRingbondCount()<1||e.value.getRingbondCount()<1)return null;for(var i=0;i<t.value.ringbonds.length;i++)for(var r=0;r<e.value.ringbonds.length;r++)if(t.value.ringbonds[i].id===e.value.ringbonds[r].id)return"-"===t.value.ringbonds[i].bondType?e.value.ringbonds[r].bond:t.value.ringbonds[i].bond;return null}initDraw(t,e,i){this.data=t,this.infoOnly=i,this.ringIdCounter=0,this.ringConnectionIdCounter=0,this.graph=new u(t,this.opts.isomeric),this.rings=Array(),this.ringConnections=Array(),this.originalRings=Array(),this.originalRingConnections=Array(),this.bridgedRing=!1,this.doubleBondConfigCount=null,this.doubleBondConfig=null,this.initRings(),this.initHydrogens()}processGraph(){this.position(),this.restoreRingInformation(),this.resolvePrimaryOverlaps();let t=this.getOverlapScore();this.totalOverlapScore=this.getOverlapScore().total;for(var e=0;e<this.opts.overlapResolutionIterations;e++)for(var i=0;i<this.graph.edges.length;i++){let e=this.graph.edges[i];if(this.isEdgeRotatable(e)){let i=this.graph.getTreeDepth(e.sourceId,e.targetId),n=this.graph.getTreeDepth(e.targetId,e.sourceId),s=e.targetId,o=e.sourceId;if(i>n&&(s=e.sourceId,o=e.targetId),this.getSubtreeOverlapScore(o,s,t.vertexScores).value>this.opts.overlapSensitivity){let e=this.graph.vertices[s],i=this.graph.vertices[o],n=i.getNeighbours(s);if(1===n.length){let t=this.graph.vertices[n[0]],s=t.position.getRotateAwayFromAngle(e.position,i.position,r.toRad(120));this.rotateSubtree(t.id,i.id,s,i.position);let o=this.getOverlapScore().total;o>this.totalOverlapScore?this.rotateSubtree(t.id,i.id,-s,i.position):this.totalOverlapScore=o}else if(2===n.length){if(0!==i.value.rings.length&&0!==e.value.rings.length)continue;let t=this.graph.vertices[n[0]],s=this.graph.vertices[n[1]];if(1===t.value.rings.length&&1===s.value.rings.length){if(t.value.rings[0]!==s.value.rings[0])continue}else{if(0!==t.value.rings.length||0!==s.value.rings.length)continue;{let n=t.position.getRotateAwayFromAngle(e.position,i.position,r.toRad(120)),o=s.position.getRotateAwayFromAngle(e.position,i.position,r.toRad(120));this.rotateSubtree(t.id,i.id,n,i.position),this.rotateSubtree(s.id,i.id,o,i.position);let a=this.getOverlapScore().total;a>this.totalOverlapScore?(this.rotateSubtree(t.id,i.id,-n,i.position),this.rotateSubtree(s.id,i.id,-o,i.position)):this.totalOverlapScore=a}}}t=this.getOverlapScore()}}}this.resolveSecondaryOverlaps(t.scores),this.opts.isomeric&&this.annotateStereochemistry(),this.opts.compactDrawing&&"default"===this.opts.atomVisualization&&this.initPseudoElements(),this.rotateDrawing()}initRings(){let t=new Map;for(var e=this.graph.vertices.length-1;e>=0;e--){let r=this.graph.vertices[e];if(0!==r.value.ringbonds.length)for(var i=0;i<r.value.ringbonds.length;i++){let e=r.value.ringbonds[i].id,n=r.value.ringbonds[i].bond;if(t.has(e)){let s=r.id,o=t.get(e)[0],h=t.get(e)[1],l=new a(s,o,1);l.setBondType(h||n||"-");let g=this.graph.addEdge(l),d=this.graph.vertices[o];r.addRingbondChild(o,i),r.value.addNeighbouringElement(d.value.element),d.addRingbondChild(s,i),d.value.addNeighbouringElement(r.value.element),r.edges.push(g),d.edges.push(g),t.delete(e)}else t.set(e,[r.id,n])}}let r=c.getRings(this.graph,this.opts.experimentalSSSR);if(null!==r){for(e=0;e<r.length;e++){let t=[...r[e]],n=this.addRing(new l(t));for(i=0;i<t.length;i++)this.graph.vertices[t[i]].value.rings.push(n)}for(e=0;e<this.rings.length-1;e++)for(i=e+1;i<this.rings.length;i++){let t=this.rings[e],r=this.rings[i],n=new g(t,r);n.vertices.size>0&&this.addRingConnection(n)}for(e=0;e<this.rings.length;e++){let t=this.rings[e];t.neighbours=g.getNeighbours(this.ringConnections,t.id)}for(e=0;e<this.rings.length;e++){let t=this.rings[e];this.graph.vertices[t.members[0]].value.addAnchoredRing(t.id)}for(this.backupRingInformation();this.rings.length>0;){let t=-1;for(e=0;e<this.rings.length;e++){let i=this.rings[e];this.isPartOfBridgedRing(i.id)&&!i.isBridged&&(t=i.id)}if(-1===t)break;let i=this.getRing(t),r=this.getBridgedRingRings(i.id);for(this.bridgedRing=!0,this.createBridgedRing(r,i.members[0]),e=0;e<r.length;e++)this.removeRing(r[e])}}}initHydrogens(){if(!this.opts.explicitHydrogens)for(var t=0;t<this.graph.vertices.length;t++){let e=this.graph.vertices[t];if("H"!==e.value.element)continue;let i=this.graph.vertices[e.neighbours[0]];i.value.hasHydrogen=!0,(!i.value.isStereoCenter||i.value.rings.length<2&&!i.value.bridgedRing||i.value.bridgedRing&&i.value.originalRings.length<2)&&(e.value.isDrawn=!1)}}getBridgedRingRings(t){let e=Array(),i=this,r=function(t){let n=i.getRing(t);e.push(t);for(var s=0;s<n.neighbours.length;s++){let o=n.neighbours[s];-1===e.indexOf(o)&&o!==t&&g.isBridge(i.ringConnections,i.graph.vertices,t,o)&&r(o)}};return r(t),n.unique(e)}isPartOfBridgedRing(t){for(var e=0;e<this.ringConnections.length;e++)if(this.ringConnections[e].containsRing(t)&&this.ringConnections[e].isBridge(this.graph.vertices))return!0;return!1}createBridgedRing(t,e){let i=new Set,r=new Set,s=new Set;for(var o=0;o<t.length;o++){let e=this.getRing(t[o]);e.isPartOfBridged=!0;for(var a=0;a<e.members.length;a++)r.add(e.members[a]);for(a=0;a<e.neighbours.length;a++){let i=e.neighbours[a];-1===t.indexOf(i)&&s.add(e.neighbours[a])}}let h=new Set;for(let e of r){let r=this.graph.vertices[e],s=n.intersection(t,r.value.rings);1===r.value.rings.length||1===s.length?i.add(r.id):h.add(r.id)}Array();let g=Array();for(let t of h){let e=this.graph.vertices[t],r=!1;for(let t=0;t<e.edges.length;t++)1===this.edgeRingCount(e.edges[t])&&(r=!0);r?(e.value.isBridgeNode=!0,i.add(e.id)):(e.value.isBridge=!0,i.add(e.id))}let d=new l([...i]);for(this.addRing(d),d.isBridged=!0,d.neighbours=[...s],o=0;o<t.length;o++)d.rings.push(this.getRing(t[o]).clone());for(o=0;o<d.members.length;o++)this.graph.vertices[d.members[o]].value.bridgedRing=d.id;for(o=0;o<g.length;o++)this.graph.vertices[g[o]].value.rings=Array();for(let e of i){let i=this.graph.vertices[e];i.value.rings=n.removeAll(i.value.rings,t),i.value.rings.push(d.id)}for(o=0;o<t.length;o++)for(a=o+1;a<t.length;a++)this.removeRingConnectionsBetween(t[o],t[a]);for(let e of s){let i=this.getRingConnections(e,t);for(a=0;a<i.length;a++)this.getRingConnection(i[a]).updateOther(d.id,e);this.getRing(e).neighbours.push(d.id)}return d}areVerticesInSameRing(t,e){for(var i=0;i<t.value.rings.length;i++)for(var r=0;r<e.value.rings.length;r++)if(t.value.rings[i]===e.value.rings[r])return!0;return!1}getCommonRings(t,e){let i=Array();for(var r=0;r<t.value.rings.length;r++)for(var n=0;n<e.value.rings.length;n++)t.value.rings[r]==e.value.rings[n]&&i.push(t.value.rings[r]);return i}getLargestOrAromaticCommonRing(t,e){let i=this.getCommonRings(t,e),r=0,n=null;for(var s=0;s<i.length;s++){let t=this.getRing(i[s]),e=t.getSize();if(t.isBenzeneLike(this.graph.vertices))return t;e>r&&(r=e,n=t)}return n}getVerticesAt(t,e,i){let r=Array();for(var n=0;n<this.graph.vertices.length;n++){let s=this.graph.vertices[n];s.id!==i&&s.positioned&&t.distanceSq(s.position)<=e*e&&r.push(s.id)}return r}getClosestVertex(t){let e=99999,i=null;for(var r=0;r<this.graph.vertices.length;r++){let n=this.graph.vertices[r];if(n.id===t.id)continue;let s=t.position.distanceSq(n.position);s<e&&(e=s,i=n)}return i}addRing(t){return t.id=this.ringIdCounter++,this.rings.push(t),t.id}removeRing(t){this.rings=this.rings.filter((function(e){return e.id!==t})),this.ringConnections=this.ringConnections.filter((function(e){return e.firstRingId!==t&&e.secondRingId!==t}));for(var e=0;e<this.rings.length;e++){let i=this.rings[e];i.neighbours=i.neighbours.filter((function(e){return e!==t}))}}getRing(t){for(var e=0;e<this.rings.length;e++)if(this.rings[e].id==t)return this.rings[e]}addRingConnection(t){return t.id=this.ringConnectionIdCounter++,this.ringConnections.push(t),t.id}removeRingConnection(t){this.ringConnections=this.ringConnections.filter((function(e){return e.id!==t}))}removeRingConnectionsBetween(t,e){let i=Array();for(var r=0;r<this.ringConnections.length;r++){let n=this.ringConnections[r];(n.firstRingId===t&&n.secondRingId===e||n.firstRingId===e&&n.secondRingId===t)&&i.push(n.id)}for(r=0;r<i.length;r++)this.removeRingConnection(i[r])}getRingConnection(t){for(var e=0;e<this.ringConnections.length;e++)if(this.ringConnections[e].id==t)return this.ringConnections[e]}getRingConnections(t,e){let i=Array();for(var r=0;r<this.ringConnections.length;r++){let s=this.ringConnections[r];for(var n=0;n<e.length;n++){let r=e[n];(s.firstRingId===t&&s.secondRingId===r||s.firstRingId===r&&s.secondRingId===t)&&i.push(s.id)}}return i}getOverlapScore(){let t=0,e=new Float32Array(this.graph.vertices.length);for(var i=0;i<this.graph.vertices.length;i++)e[i]=0;for(i=0;i<this.graph.vertices.length;i++)for(var r=this.graph.vertices.length;--r>i;){let n=this.graph.vertices[i],o=this.graph.vertices[r];if(!n.value.isDrawn||!o.value.isDrawn)continue;let a=s.subtract(n.position,o.position).lengthSq();if(a<this.opts.bondLengthSq){let n=(this.opts.bondLength-Math.sqrt(a))/this.opts.bondLength;t+=n,e[i]+=n,e[r]+=n}}let n=Array();for(i=0;i<this.graph.vertices.length;i++)n.push({id:i,score:e[i]});return n.sort((function(t,e){return e.score-t.score})),{total:t,scores:n,vertexScores:e}}chooseSide(t,e,i){let r=t.getNeighbours(e.id),s=e.getNeighbours(t.id),o=r.length,a=s.length,h=n.merge(r,s),l=[0,0];for(var g=0;g<h.length;g++)this.graph.vertices[h[g]].position.sameSideAs(t.position,e.position,i[0])?l[0]++:l[1]++;let d=[0,0];for(g=0;g<this.graph.vertices.length;g++)this.graph.vertices[g].position.sameSideAs(t.position,e.position,i[0])?d[0]++:d[1]++;return{totalSideCount:d,totalPosition:d[0]>d[1]?0:1,sideCount:l,position:l[0]>l[1]?0:1,anCount:o,bnCount:a}}setRingCenter(t){let e=t.getSize(),i=new s(0,0);for(var r=0;r<e;r++)i.add(this.graph.vertices[t.members[r]].position);t.center=i.divide(e)}getSubringCenter(t,e){let i=e.value.originalRings,r=t.center,n=Number.MAX_VALUE;for(var s=0;s<i.length;s++)for(var o=0;o<t.rings.length;o++)i[s]===t.rings[o].id&&t.rings[o].getSize()<n&&(r=t.rings[o].center,n=t.rings[o].getSize());return r}drawEdges(t){let e=this,i=Array(this.graph.edges.length);if(i.fill(!1),this.graph.traverseBF(0,(function(r){let n=e.graph.getEdges(r.id);for(var s=0;s<n.length;s++){let r=n[s];i[r]||(i[r]=!0,e.drawEdge(r,t))}})),!this.bridgedRing)for(var r=0;r<this.rings.length;r++){let t=this.rings[r];this.isRingAromatic(t)&&this.canvasWrapper.drawAromaticityRing(t)}}drawEdge(t,e){let i=this,r=this.graph.edges[t],a=this.graph.vertices[r.sourceId],h=this.graph.vertices[r.targetId],l=a.value.element,g=h.value.element;if(!(a.value.isDrawn&&h.value.isDrawn||"default"!==this.opts.atomVisualization))return;let d=a.position,u=h.position,c=this.getEdgeNormals(r),p=n.clone(c);if(p[0].multiplyScalar(10).add(d),p[1].multiplyScalar(10).add(d),"="===r.bondType||"="===this.getRingbondType(a,h)||r.isPartOfAromaticRing&&this.bridgedRing){let t=this.areVerticesInSameRing(a,h),e=this.chooseSide(a,h,p);if(t){let t=this.getLargestOrAromaticCommonRing(a,h).center;c[0].multiplyScalar(i.opts.bondSpacing),c[1].multiplyScalar(i.opts.bondSpacing);let e=null;e=t.sameSideAs(a.position,h.position,s.add(d,c[0]))?new o(s.add(d,c[0]),s.add(u,c[0]),l,g):new o(s.add(d,c[1]),s.add(u,c[1]),l,g),e.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),r.isPartOfAromaticRing?this.canvasWrapper.drawLine(e,!0):this.canvasWrapper.drawLine(e),this.canvasWrapper.drawLine(new o(d,u,l,g))}else if(r.center||a.isTerminal()&&h.isTerminal()){c[0].multiplyScalar(i.opts.halfBondSpacing),c[1].multiplyScalar(i.opts.halfBondSpacing);let t=new o(s.add(d,c[0]),s.add(u,c[0]),l,g),e=new o(s.add(d,c[1]),s.add(u,c[1]),l,g);this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(e)}else if(0==e.anCount&&e.bnCount>1||0==e.bnCount&&e.anCount>1){c[0].multiplyScalar(i.opts.halfBondSpacing),c[1].multiplyScalar(i.opts.halfBondSpacing);let t=new o(s.add(d,c[0]),s.add(u,c[0]),l,g),e=new o(s.add(d,c[1]),s.add(u,c[1]),l,g);this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(e)}else if(e.sideCount[0]>e.sideCount[1]){c[0].multiplyScalar(i.opts.bondSpacing),c[1].multiplyScalar(i.opts.bondSpacing);let t=new o(s.add(d,c[0]),s.add(u,c[0]),l,g);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new o(d,u,l,g))}else if(e.sideCount[0]<e.sideCount[1]){c[0].multiplyScalar(i.opts.bondSpacing),c[1].multiplyScalar(i.opts.bondSpacing);let t=new o(s.add(d,c[1]),s.add(u,c[1]),l,g);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new o(d,u,l,g))}else if(e.totalSideCount[0]>e.totalSideCount[1]){c[0].multiplyScalar(i.opts.bondSpacing),c[1].multiplyScalar(i.opts.bondSpacing);let t=new o(s.add(d,c[0]),s.add(u,c[0]),l,g);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new o(d,u,l,g))}else if(e.totalSideCount[0]<=e.totalSideCount[1]){c[0].multiplyScalar(i.opts.bondSpacing),c[1].multiplyScalar(i.opts.bondSpacing);let t=new o(s.add(d,c[1]),s.add(u,c[1]),l,g);t.shorten(this.opts.bondLength-this.opts.shortBondLength*this.opts.bondLength),this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(new o(d,u,l,g))}}else if("#"===r.bondType){c[0].multiplyScalar(i.opts.bondSpacing/1.5),c[1].multiplyScalar(i.opts.bondSpacing/1.5);let t=new o(s.add(d,c[0]),s.add(u,c[0]),l,g),e=new o(s.add(d,c[1]),s.add(u,c[1]),l,g);this.canvasWrapper.drawLine(t),this.canvasWrapper.drawLine(e),this.canvasWrapper.drawLine(new o(d,u,l,g))}else if("."===r.bondType);else{let t=a.value.isStereoCenter,e=h.value.isStereoCenter;"up"===r.wedge?this.canvasWrapper.drawWedge(new o(d,u,l,g,t,e)):"down"===r.wedge?this.canvasWrapper.drawDashedWedge(new o(d,u,l,g,t,e)):this.canvasWrapper.drawLine(new o(d,u,l,g,t,e))}if(e){let e=s.midpoint(d,u);this.canvasWrapper.drawDebugText(e.x,e.y,"e: "+t)}}drawVertices(t){var e=this.graph.vertices.length;for(e=0;e<this.graph.vertices.length;e++){let i=this.graph.vertices[e],r=i.value,o=0,a=0,l=i.value.bondCount,g=r.element,d=h.maxBonds[g]-l,u=i.getTextDirection(this.graph.vertices),c=!(!this.opts.terminalCarbons&&"C"===g&&!r.hasAttachedPseudoElements)&&i.isTerminal(),p="C"===r.element;if("N"===r.element&&r.isPartOfAromaticRing&&(d=0),r.bracket&&(d=r.bracket.hcount,o=r.bracket.charge,a=r.bracket.isotope),"allballs"===this.opts.atomVisualization)this.canvasWrapper.drawBall(i.position.x,i.position.y,g);else if(r.isDrawn&&(!p||r.drawExplicit||c||r.hasAttachedPseudoElements)||1===this.graph.vertices.length)"default"===this.opts.atomVisualization?this.canvasWrapper.drawText(i.position.x,i.position.y,g,d,u,c,o,a,r.getAttachedPseudoElements()):"balls"===this.opts.atomVisualization&&this.canvasWrapper.drawBall(i.position.x,i.position.y,g);else if(2===i.getNeighbourCount()&&1==i.forcePositioned){let t=this.graph.vertices[i.neighbours[0]].position,e=this.graph.vertices[i.neighbours[1]].position,r=s.threePointangle(i.position,t,e);Math.abs(Math.PI-r)<.1&&this.canvasWrapper.drawPoint(i.position.x,i.position.y,g)}if(t){let t="v: "+i.id+" "+n.print(r.ringbonds);this.canvasWrapper.drawDebugText(i.position.x,i.position.y,t)}}if(this.opts.debug)for(e=0;e<this.rings.length;e++){let t=this.rings[e].center;this.canvasWrapper.drawDebugPoint(t.x,t.y,"r: "+this.rings[e].id)}}position(){let t=null;for(var e=0;e<this.graph.vertices.length;e++)if(null!==this.graph.vertices[e].value.bridgedRing){t=this.graph.vertices[e];break}for(e=0;e<this.rings.length;e++)this.rings[e].isBridged&&(t=this.graph.vertices[this.rings[e].members[0]]);this.rings.length>0&&null===t&&(t=this.graph.vertices[this.rings[0].members[0]]),null===t&&(t=this.graph.vertices[0]),this.createNextBond(t,null,0)}backupRingInformation(){this.originalRings=Array(),this.originalRingConnections=Array();for(var t=0;t<this.rings.length;t++)this.originalRings.push(this.rings[t]);for(t=0;t<this.ringConnections.length;t++)this.originalRingConnections.push(this.ringConnections[t]);for(t=0;t<this.graph.vertices.length;t++)this.graph.vertices[t].value.backupRings()}restoreRingInformation(){let t=this.getBridgedRings();this.rings=Array(),this.ringConnections=Array();for(var e=0;e<t.length;e++){let r=t[e];for(var i=0;i<r.rings.length;i++){let t=r.rings[i];this.originalRings[t.id].center=t.center}}for(e=0;e<this.originalRings.length;e++)this.rings.push(this.originalRings[e]);for(e=0;e<this.originalRingConnections.length;e++)this.ringConnections.push(this.originalRingConnections[e]);for(e=0;e<this.graph.vertices.length;e++)this.graph.vertices[e].value.restoreRings()}createRing(t,e=null,i=null,n=null){if(t.positioned)return;e=e||new s(0,0);let o=t.getOrderedNeighbours(this.ringConnections),a=i?s.subtract(i.position,e).angle():0,h=r.polyCircumradius(this.opts.bondLength,t.getSize()),l=r.centralAngle(t.getSize());t.centralAngle=l;let d=a,u=this,c=i?i.id:null;if(-1===t.members.indexOf(c)&&(i&&(i.positioned=!1),c=t.members[0]),t.isBridged){this.graph.kkLayout(t.members.slice(),e,i.id,t,this.opts.bondLength,this.opts.kkThreshold,this.opts.kkInnerThreshold,this.opts.kkMaxIteration,this.opts.kkMaxInnerIteration,this.opts.kkMaxEnergy),t.positioned=!0,this.setRingCenter(t),e=t.center;for(var p=0;p<t.rings.length;p++)this.setRingCenter(t.rings[p])}else t.eachMember(this.graph.vertices,(function(i){let r=u.graph.vertices[i];r.positioned||r.setPosition(e.x+Math.cos(d)*h,e.y+Math.sin(d)*h),d+=l,(!t.isBridged||t.rings.length<3)&&(r.angle=d,r.positioned=!0)}),c,n?n.id:null);for(t.positioned=!0,t.center=e,p=0;p<o.length;p++){let i=this.getRing(o[p].neighbour);if(i.positioned)continue;let n=g.getVertices(this.ringConnections,t.id,i.id);if(2===n.length){t.isFused=!0,i.isFused=!0;let o=this.graph.vertices[n[0]],a=this.graph.vertices[n[1]],h=s.midpoint(o.position,a.position),l=s.normals(o.position,a.position);l[0].normalize(),l[1].normalize();let g=r.polyCircumradius(this.opts.bondLength,i.getSize()),d=r.apothem(g,i.getSize());l[0].multiplyScalar(d).add(h),l[1].multiplyScalar(d).add(h);let u=l[0];s.subtract(e,l[1]).lengthSq()>s.subtract(e,l[0]).lengthSq()&&(u=l[1]);let c=s.subtract(o.position,u),p=s.subtract(a.position,u);-1===c.clockwise(p)?i.positioned||this.createRing(i,u,o,a):i.positioned||this.createRing(i,u,a,o)}else if(1===n.length){t.isSpiro=!0,i.isSpiro=!0;let o=this.graph.vertices[n[0]],a=s.subtract(e,o.position);a.invert(),a.normalize();let h=r.polyCircumradius(this.opts.bondLength,i.getSize());a.multiplyScalar(h),a.add(o.position),i.positioned||this.createRing(i,a,o)}}for(p=0;p<t.members.length;p++){let e=this.graph.vertices[t.members[p]],i=e.neighbours;for(var f=0;f<i.length;f++){let t=this.graph.vertices[i[f]];t.positioned||(t.value.isConnectedToRing=!0,this.createNextBond(t,e,0))}}}rotateSubtree(t,e,i,r){let n=this;this.graph.traverseTree(t,e,(function(t){t.position.rotateAround(i,r);for(var e=0;e<t.value.anchoredRings.length;e++){let s=n.rings[t.value.anchoredRings[e]];s&&s.center.rotateAround(i,r)}}))}getSubtreeOverlapScore(t,e,i){let r=this,n=0,o=new s(0,0),a=0;return this.graph.traverseTree(t,e,(function(t){if(!t.value.isDrawn)return;let e=i[t.id];e>r.opts.overlapSensitivity&&(n+=e,a++);let s=r.graph.vertices[t.id].position.clone();s.multiplyScalar(e),o.add(s)})),o.divide(n),{value:n/a,center:o}}getCurrentCenterOfMass(){let t=new s(0,0),e=0;for(var i=0;i<this.graph.vertices.length;i++){let r=this.graph.vertices[i];r.positioned&&(t.add(r.position),e++)}return t.divide(e)}getCurrentCenterOfMassInNeigbourhood(t,e=2*this.opts.bondLength){let i=new s(0,0),r=0,n=e*e;for(var o=0;o<this.graph.vertices.length;o++){let e=this.graph.vertices[o];e.positioned&&t.distanceSq(e.position)<n&&(i.add(e.position),r++)}return i.divide(r)}resolvePrimaryOverlaps(){let t=Array(),e=Array(this.graph.vertices.length);for(var i=0;i<this.rings.length;i++){let s=this.rings[i];for(var r=0;r<s.members.length;r++){let i=this.graph.vertices[s.members[r]];if(e[i.id])continue;e[i.id]=!0;let o=this.getNonRingNeighbours(i.id);if(o.length>1){let e=Array();for(var n=0;n<i.value.rings.length;n++)e.push(i.value.rings[n]);t.push({common:i,rings:e,vertices:o})}else if(1===o.length&&2===i.value.rings.length){let e=Array();for(n=0;n<i.value.rings.length;n++)e.push(i.value.rings[n]);t.push({common:i,rings:e,vertices:o})}}}for(i=0;i<t.length;i++){let e=t[i];if(2===e.vertices.length){let t=e.vertices[0],i=e.vertices[1];if(!t.value.isDrawn||!i.value.isDrawn)continue;let r=(2*Math.PI-this.getRing(e.rings[0]).getAngle())/6;this.rotateSubtree(t.id,e.common.id,r,e.common.position),this.rotateSubtree(i.id,e.common.id,-r,e.common.position);let n=this.getOverlapScore(),s=this.getSubtreeOverlapScore(t.id,e.common.id,n.vertexScores),o=this.getSubtreeOverlapScore(i.id,e.common.id,n.vertexScores),a=s.value+o.value;this.rotateSubtree(t.id,e.common.id,-2*r,e.common.position),this.rotateSubtree(i.id,e.common.id,2*r,e.common.position),n=this.getOverlapScore(),s=this.getSubtreeOverlapScore(t.id,e.common.id,n.vertexScores),o=this.getSubtreeOverlapScore(i.id,e.common.id,n.vertexScores),s.value+o.value>a&&(this.rotateSubtree(t.id,e.common.id,2*r,e.common.position),this.rotateSubtree(i.id,e.common.id,-2*r,e.common.position))}else 1===e.vertices.length&&e.rings.length}}resolveSecondaryOverlaps(t){for(var e=0;e<t.length;e++)if(t[e].score>this.opts.overlapSensitivity){let i=this.graph.vertices[t[e].id];if(i.isTerminal()){let t=this.getClosestVertex(i);if(t){let e=null;e=t.isTerminal()?0===t.id?this.graph.vertices[1].position:t.previousPosition:0===t.id?this.graph.vertices[1].position:t.position;let n=0===i.id?this.graph.vertices[1].position:i.previousPosition;i.position.rotateAwayFrom(e,n,r.toRad(20))}}}}getLastVertexWithAngle(t){let e=0,i=null;for(;!e&&t;)i=this.graph.vertices[t],e=i.angle,t=i.parentVertexId;return i}createNextBond(t,e=null,i=0,o=!1,a=!1){if(t.positioned&&!a)return;let h=!1;if(e){let i=this.graph.getEdge(t.id,e.id);"/"!==i.bondType&&"\\"!==i.bondType||++this.doubleBondConfigCount%2!=1||null===this.doubleBondConfig&&(this.doubleBondConfig=i.bondType,h=!0,null===e.parentVertexId&&t.value.branchBond&&("/"===this.doubleBondConfig?this.doubleBondConfig="\\":"\\"===this.doubleBondConfig&&(this.doubleBondConfig="/")))}if(!a)if(e)if(e.value.rings.length>0){let i=e.neighbours,r=null,o=new s(0,0);if(null===e.value.bridgedRing&&e.value.rings.length>1)for(var l=0;l<i.length;l++){let t=this.graph.vertices[i[l]];if(n.containsAll(t.value.rings,e.value.rings)){r=t;break}}if(null===r){for(l=0;l<i.length;l++){let t=this.graph.vertices[i[l]];t.positioned&&this.areVerticesInSameRing(t,e)&&o.add(s.subtract(t.position,e.position))}o.invert().normalize().multiplyScalar(this.opts.bondLength).add(e.position)}else o=r.position.clone().rotateAround(Math.PI,e.position);t.previousPosition=e.position,t.setPositionFromVector(o),t.positioned=!0}else{let r=new s(this.opts.bondLength,0);r.rotate(i),r.add(e.position),t.setPositionFromVector(r),t.previousPosition=e.position,t.positioned=!0}else{let e=new s(this.opts.bondLength,0);e.rotate(r.toRad(-60)),t.previousPosition=e,t.setPosition(this.opts.bondLength,0),t.angle=r.toRad(-60),null===t.value.bridgedRing&&(t.positioned=!0)}if(null!==t.value.bridgedRing){let e=this.getRing(t.value.bridgedRing);if(!e.positioned){let i=s.subtract(t.previousPosition,t.position);i.invert(),i.normalize();let n=r.polyCircumradius(this.opts.bondLength,e.members.length);i.multiplyScalar(n),i.add(t.position),this.createRing(e,i,t)}}else if(t.value.rings.length>0){let e=this.getRing(t.value.rings[0]);if(!e.positioned){let i=s.subtract(t.previousPosition,t.position);i.invert(),i.normalize();let n=r.polyCircumradius(this.opts.bondLength,e.getSize());i.multiplyScalar(n),i.add(t.position),this.createRing(e,i,t)}}else{t.value.isStereoCenter;let i=t.getNeighbours(),a=Array();for(l=0;l<i.length;l++)this.graph.vertices[i[l]].value.isDrawn&&a.push(i[l]);e&&(a=n.remove(a,e.id));let g=t.getAngle();if(1===a.length){let i=this.graph.vertices[a[0]];if("#"===t.value.bondType||e&&"#"===e.value.bondType||"="===t.value.bondType&&e&&0===e.value.rings.length&&"="===e.value.bondType&&"-"!==t.value.branchBond)t.value.drawExplicit=!1,e&&(this.graph.getEdge(t.id,e.id).center=!0),this.graph.getEdge(t.id,i.id).center=!0,("#"===t.value.bondType||e&&"#"===e.value.bondType)&&(i.angle=0),i.drawExplicit=!0,this.createNextBond(i,t,g+i.angle);else if(e&&e.value.rings.length>0){let e=r.toRad(60),n=-e,o=new s(this.opts.bondLength,0),a=new s(this.opts.bondLength,0);o.rotate(e).add(t.position),a.rotate(n).add(t.position);let h=this.getCurrentCenterOfMass(),l=o.distanceSq(h),d=a.distanceSq(h);i.angle=l<d?n:e,this.createNextBond(i,t,g+i.angle)}else{let r=t.angle;if(e&&e.neighbours.length>3?r=r>0?Math.min(1.0472,r):r<0?Math.max(-1.0472,r):1.0472:r||(r=this.getLastVertexWithAngle(t.id).angle,r||(r=1.0472)),e&&!h){let e=this.graph.getEdge(t.id,i.id).bondType;"/"===e?("/"===this.doubleBondConfig||"\\"===this.doubleBondConfig&&(r=-r),this.doubleBondConfig=null):"\\"===e&&("/"===this.doubleBondConfig?r=-r:this.doubleBondConfig,this.doubleBondConfig=null)}i.angle=o?r:-r,this.createNextBond(i,t,g+i.angle)}}else if(2===a.length){let i=t.angle;i||(i=1.0472);let r=this.graph.getTreeDepth(a[0],t.id),n=this.graph.getTreeDepth(a[1],t.id),s=this.graph.vertices[a[0]],o=this.graph.vertices[a[1]];s.value.subtreeDepth=r,o.value.subtreeDepth=n;let h=this.graph.getTreeDepth(e?e.id:null,t.id);e&&(e.value.subtreeDepth=h);let l=0,d=1;"C"===o.value.element&&"C"!==s.value.element&&n>1&&r<5?(l=1,d=0):"C"!==o.value.element&&"C"===s.value.element&&r>1&&n<5?(l=0,d=1):n>r&&(l=1,d=0);let u=this.graph.vertices[a[l]],c=this.graph.vertices[a[d]],p=(this.graph.getEdge(t.id,u.id),this.graph.getEdge(t.id,c.id),!1);h<r&&h<n&&(p=!0),c.angle=i,u.angle=-i,"\\"===this.doubleBondConfig?"\\"===c.value.branchBond&&(c.angle=-i,u.angle=i):"/"===this.doubleBondConfig&&"/"===c.value.branchBond&&(c.angle=-i,u.angle=i),this.createNextBond(c,t,g+c.angle,p),this.createNextBond(u,t,g+u.angle,p)}else if(3===a.length){let i=this.graph.getTreeDepth(a[0],t.id),n=this.graph.getTreeDepth(a[1],t.id),s=this.graph.getTreeDepth(a[2],t.id),o=this.graph.vertices[a[0]],h=this.graph.vertices[a[1]],l=this.graph.vertices[a[2]];o.value.subtreeDepth=i,h.value.subtreeDepth=n,l.value.subtreeDepth=s,n>i&&n>s?(o=this.graph.vertices[a[1]],h=this.graph.vertices[a[0]],l=this.graph.vertices[a[2]]):s>i&&s>n&&(o=this.graph.vertices[a[2]],h=this.graph.vertices[a[0]],l=this.graph.vertices[a[1]]),e&&e.value.rings.length<1&&o.value.rings.length<1&&h.value.rings.length<1&&l.value.rings.length<1&&1===this.graph.getTreeDepth(h.id,t.id)&&1===this.graph.getTreeDepth(l.id,t.id)&&this.graph.getTreeDepth(o.id,t.id)>1?(o.angle=-t.angle,t.angle>=0?(h.angle=r.toRad(30),l.angle=r.toRad(90)):(h.angle=-r.toRad(30),l.angle=-r.toRad(90)),this.createNextBond(o,t,g+o.angle),this.createNextBond(h,t,g+h.angle),this.createNextBond(l,t,g+l.angle)):(o.angle=0,h.angle=r.toRad(90),l.angle=-r.toRad(90),this.createNextBond(o,t,g+o.angle),this.createNextBond(h,t,g+h.angle),this.createNextBond(l,t,g+l.angle))}else if(4===a.length){let e=this.graph.getTreeDepth(a[0],t.id),i=this.graph.getTreeDepth(a[1],t.id),n=this.graph.getTreeDepth(a[2],t.id),s=this.graph.getTreeDepth(a[3],t.id),o=this.graph.vertices[a[0]],h=this.graph.vertices[a[1]],l=this.graph.vertices[a[2]],d=this.graph.vertices[a[3]];o.value.subtreeDepth=e,h.value.subtreeDepth=i,l.value.subtreeDepth=n,d.value.subtreeDepth=s,i>e&&i>n&&i>s?(o=this.graph.vertices[a[1]],h=this.graph.vertices[a[0]],l=this.graph.vertices[a[2]],d=this.graph.vertices[a[3]]):n>e&&n>i&&n>s?(o=this.graph.vertices[a[2]],h=this.graph.vertices[a[0]],l=this.graph.vertices[a[1]],d=this.graph.vertices[a[3]]):s>e&&s>i&&s>n&&(o=this.graph.vertices[a[3]],h=this.graph.vertices[a[0]],l=this.graph.vertices[a[1]],d=this.graph.vertices[a[2]]),o.angle=-r.toRad(36),h.angle=r.toRad(36),l.angle=-r.toRad(108),d.angle=r.toRad(108),this.createNextBond(o,t,g+o.angle),this.createNextBond(h,t,g+h.angle),this.createNextBond(l,t,g+l.angle),this.createNextBond(d,t,g+d.angle)}}}getCommonRingbondNeighbour(t){let e=t.neighbours;for(var i=0;i<e.length;i++){let r=this.graph.vertices[e[i]];if(n.containsAll(r.value.rings,t.value.rings))return r}return null}isPointInRing(t){for(var e=0;e<this.rings.length;e++){let i=this.rings[e];if(!i.positioned)continue;let n=r.polyCircumradius(this.opts.bondLength,i.getSize()),s=n*n;if(t.distanceSq(i.center)<s)return!0}return!1}isEdgeInRing(t){let e=this.graph.vertices[t.sourceId],i=this.graph.vertices[t.targetId];return this.areVerticesInSameRing(e,i)}isEdgeRotatable(t){let e=this.graph.vertices[t.sourceId],i=this.graph.vertices[t.targetId];return!("-"!==t.bondType||e.isTerminal()||i.isTerminal()||e.value.rings.length>0&&i.value.rings.length>0&&this.areVerticesInSameRing(e,i))}isRingAromatic(t){for(var e=0;e<t.members.length;e++)if(!this.graph.vertices[t.members[e]].value.isPartOfAromaticRing)return!1;return!0}getEdgeNormals(t){let e=this.graph.vertices[t.sourceId].position,i=this.graph.vertices[t.targetId].position;return s.units(e,i)}getNonRingNeighbours(t){let e=Array(),i=this.graph.vertices[t],r=i.neighbours;for(var s=0;s<r.length;s++){let t=this.graph.vertices[r[s]];0===n.intersection(i.value.rings,t.value.rings).length&&0==t.value.isBridge&&e.push(t)}return e}annotateStereochemistry(){for(var t=0;t<this.graph.vertices.length;t++){let s=this.graph.vertices[t];if(!s.value.isStereoCenter)continue;let o=s.getNeighbours(),a=o.length,h=Array(a);for(var e=0;e<a;e++){let t=new Uint8Array(this.graph.vertices.length),r=Array(Array());t[s.id]=1,this.visitStereochemistry(o[e],s.id,t,r,10,0);for(var i=0;i<r.length;i++)r[i].sort((function(t,e){return e-t}));h[e]=[e,r]}let l=0,g=0;for(e=0;e<h.length;e++)for(h[e][1].length>l&&(l=h[e][1].length),i=0;i<h[e][1].length;i++)h[e][1][i].length>g&&(g=h[e][1][i].length);for(e=0;e<h.length;e++){let t=l-h[e][1].length;for(i=0;i<t;i++)h[e][1].push([]);for(h[e][1].push([o[e]]),i=0;i<h[e][1].length;i++){let t=g-h[e][1][i].length;for(var n=0;n<t;n++)h[e][1][i].push(0)}}h.sort((function(t,e){for(var i=0;i<t[1].length;i++)for(var r=0;r<t[1][i].length;r++){if(t[1][i][r]>e[1][i][r])return-1;if(t[1][i][r]<e[1][i][r])return 1}return 0}));let d=new Uint8Array(a);for(e=0;e<a;e++)d[e]=h[e][0],s.value.priority=e;let u=this.graph.vertices[o[d[0]]].position,c=this.graph.vertices[o[d[1]]].position,p=this.graph.vertices[o[d[2]]].position,f=u.relativeClockwise(c,s.position),v=(u.relativeClockwise(p,s.position),-1===f),m="@"===s.value.bracket.chirality?-1:1,b=r.parityOfPermutation(d)*m==1?"R":"S",y="down",S="up";(v&&"R"!==b||!v&&"S"!==b)&&(s.value.hydrogenDirection="up",y="up",S="down"),s.value.hasHydrogen&&(this.graph.getEdge(s.id,o[d[d.length-1]]).wedge=y);let w=new Array(o.length-1),x=s.value.rings.length>1&&s.value.hasHydrogen,A=s.value.hasHydrogen?1:0;for(e=0;e<d.length-A;e++){w[e]=new Uint32Array(2);let t=this.graph.vertices[o[d[e]]];w[e][0]+=t.value.isStereoCenter?0:1e5,w[e][0]+=this.areVerticesInSameRing(t,s)?0:1e4,w[e][0]+=t.value.isHeteroAtom()?1e3:0,w[e][0]-=0===t.value.subtreeDepth?1e3:0,w[e][0]+=1e3-t.value.subtreeDepth,w[e][1]=o[d[e]]}if(w.sort((function(t,e){return t[0]>e[0]?-1:t[0]<e[0]?1:0})),!x){let t=w[0][1];if(s.value.hasHydrogen)this.graph.getEdge(s.id,t).wedge=S;else{let i=S;for(e=d.length-1;e>=0&&(i=i===y?S:y,o[d[e]]!==t);e--);this.graph.getEdge(s.id,t).wedge=i}}s.value.chirality=b}}visitStereochemistry(t,e,i,r,n,s,o=0){i[t]=1;let a=this.graph.vertices[t],h=a.value.getAtomicNumber();r.length<=s&&r.push(Array());for(var l=0;l<this.graph.getEdge(t,e).weight;l++)r[s].push(1e3*o+h);let g=this.graph.vertices[t].neighbours;for(l=0;l<g.length;l++)1!==i[g[l]]&&s<n-1&&this.visitStereochemistry(g[l],t,i.slice(),r,n,s+1,h);if(s<n-1){let e=0;for(l=0;l<g.length;l++)e+=this.graph.getEdge(t,g[l]).weight;for(l=0;l<a.value.getMaxBonds()-e;l++)r.length<=s+1&&r.push(Array()),r[s+1].push(1e3*h+1)}}initPseudoElements(){for(var t=0;t<this.graph.vertices.length;t++){const i=this.graph.vertices[t],r=i.neighbours;let n=Array(r.length);for(var e=0;e<r.length;e++)n[e]=this.graph.vertices[r[e]];if(i.getNeighbourCount()<3||i.value.rings.length>0)continue;if("P"===i.value.element)continue;if("C"===i.value.element&&3===n.length&&"N"===n[0].value.element&&"N"===n[1].value.element&&"N"===n[2].value.element)continue;let s=0,o=0;for(e=0;e<n.length;e++){let t=n[e],i=t.value.element,r=t.getNeighbourCount();"C"!==i&&"H"!==i&&1===r&&s++,r>1&&o++}if(o>1||s<2)continue;let a=null;for(e=0;e<n.length;e++){let t=n[e];t.getNeighbourCount()>1&&(a=t)}for(e=0;e<n.length;e++){let t=n[e];if(t.getNeighbourCount()>1)continue;t.value.isDrawn=!1;let r=h.maxBonds[t.value.element]-t.value.bondCount,s="";t.value.bracket&&(r=t.value.bracket.hcount,s=t.value.bracket.charge||0),i.value.attachPseudoElement(t.value.element,a?a.value.element:null,r,s)}}for(t=0;t<this.graph.vertices.length;t++){const i=this.graph.vertices[t],r=i.value,n=r.element;if("C"===n||"H"===n||!r.isDrawn)continue;const s=i.neighbours;let o=Array(s.length);for(e=0;e<s.length;e++)o[e]=this.graph.vertices[s[e]];for(e=0;e<o.length;e++){let t=o[e].value;if(!t.hasAttachedPseudoElements||2!==t.getAttachedPseudoElementsCount())continue;const r=t.getAttachedPseudoElements();r.hasOwnProperty("0O")&&r.hasOwnProperty("3C")&&(t.isDrawn=!1,i.value.attachPseudoElement("Ac","",0))}}}}},826:t=>{class e{constructor(t,e,i=1){this.id=null,this.sourceId=t,this.targetId=e,this.weight=i,this.bondType="-",this.isPartOfAromaticRing=!1,this.center=!1,this.wedge=""}setBondType(t){this.bondType=t,this.weight=e.bonds[t]}static get bonds(){return{"-":1,"/":1,"\\":1,"=":2,"#":3,$:4}}}t.exports=e},707:(t,e,i)=>{const r=i(474),n=(i(614),i(843)),s=i(826),o=(i(421),i(427));class a{constructor(t,e=!1){this.vertices=Array(),this.edges=Array(),this.vertexIdsToEdgeId={},this.isomeric=e,this._time=0,this._init(t)}_init(t,e=0,i=null,r=!1){let a=new o(t.atom.element?t.atom.element:t.atom,t.bond);a.branchBond=t.branchBond,a.ringbonds=t.ringbonds,a.bracket=t.atom.element?t.atom:null;let h=new n(a),l=this.vertices[i];if(this.addVertex(h),null!==i){h.setParentVertexId(i),h.value.addNeighbouringElement(l.value.element),l.addChild(h.id),l.value.addNeighbouringElement(a.element),l.spanningTreeChildren.push(h.id);let t=new s(i,h.id,1),e=null;r?(t.setBondType(h.value.branchBond||"-"),e=h.id,t.setBondType(h.value.branchBond||"-"),e=h.id):(t.setBondType(l.value.bondType||"-"),e=l.id),this.addEdge(t)}let g=t.ringbondCount+1;a.bracket&&(g+=a.bracket.hcount);let d=0;if(a.bracket&&a.bracket.chirality){a.isStereoCenter=!0,d=a.bracket.hcount;for(var u=0;u<d;u++)this._init({atom:"H",isBracket:"false",branches:Array(),branchCount:0,ringbonds:Array(),ringbondCount:!1,next:null,hasNext:!1,bond:"-"},u,h.id,!0)}for(u=0;u<t.branchCount;u++)this._init(t.branches[u],u+g,h.id,!0);t.hasNext&&this._init(t.next,t.branchCount+g,h.id)}clear(){this.vertices=Array(),this.edges=Array(),this.vertexIdsToEdgeId={}}addVertex(t){return t.id=this.vertices.length,this.vertices.push(t),t.id}addEdge(t){let e=this.vertices[t.sourceId],i=this.vertices[t.targetId];return t.id=this.edges.length,this.edges.push(t),this.vertexIdsToEdgeId[t.sourceId+"_"+t.targetId]=t.id,this.vertexIdsToEdgeId[t.targetId+"_"+t.sourceId]=t.id,t.isPartOfAromaticRing=e.value.isPartOfAromaticRing&&i.value.isPartOfAromaticRing,e.value.bondCount+=t.weight,i.value.bondCount+=t.weight,e.edges.push(t.id),i.edges.push(t.id),t.id}getEdge(t,e){let i=this.vertexIdsToEdgeId[t+"_"+e];return void 0===i?null:this.edges[i]}getEdges(t){let e=Array(),i=this.vertices[t];for(var r=0;r<i.neighbours.length;r++)e.push(this.vertexIdsToEdgeId[t+"_"+i.neighbours[r]]);return e}hasEdge(t,e){return void 0!==this.vertexIdsToEdgeId[t+"_"+e]}getVertexList(){let t=[this.vertices.length];for(var e=0;e<this.vertices.length;e++)t[e]=this.vertices[e].id;return t}getEdgeList(){let t=Array(this.edges.length);for(var e=0;e<this.edges.length;e++)t[e]=[this.edges[e].sourceId,this.edges[e].targetId];return t}getAdjacencyMatrix(){let t=this.vertices.length,e=Array(t);for(var i=0;i<t;i++)e[i]=new Array(t),e[i].fill(0);for(i=0;i<this.edges.length;i++){let t=this.edges[i];e[t.sourceId][t.targetId]=1,e[t.targetId][t.sourceId]=1}return e}getComponentsAdjacencyMatrix(){let t=this.vertices.length,e=Array(t),i=this.getBridges();for(var r=0;r<t;r++)e[r]=new Array(t),e[r].fill(0);for(r=0;r<this.edges.length;r++){let t=this.edges[r];e[t.sourceId][t.targetId]=1,e[t.targetId][t.sourceId]=1}for(r=0;r<i.length;r++)e[i[r][0]][i[r][1]]=0,e[i[r][1]][i[r][0]]=0;return e}getSubgraphAdjacencyMatrix(t){let e=t.length,i=Array(e);for(var r=0;r<e;r++){i[r]=new Array(e),i[r].fill(0);for(var n=0;n<e;n++)r!==n&&this.hasEdge(t[r],t[n])&&(i[r][n]=1)}return i}getDistanceMatrix(){let t=this.vertices.length,e=this.getAdjacencyMatrix(),i=Array(t);for(var r=0;r<t;r++)i[r]=Array(t),i[r].fill(1/0);for(r=0;r<t;r++)for(var n=0;n<t;n++)1===e[r][n]&&(i[r][n]=1);for(var s=0;s<t;s++)for(r=0;r<t;r++)for(n=0;n<t;n++)i[r][n]>i[r][s]+i[s][n]&&(i[r][n]=i[r][s]+i[s][n]);return i}getSubgraphDistanceMatrix(t){let e=t.length,i=this.getSubgraphAdjacencyMatrix(t),r=Array(e);for(var n=0;n<e;n++)r[n]=Array(e),r[n].fill(1/0);for(n=0;n<e;n++)for(var s=0;s<e;s++)1===i[n][s]&&(r[n][s]=1);for(var o=0;o<e;o++)for(n=0;n<e;n++)for(s=0;s<e;s++)r[n][s]>r[n][o]+r[o][s]&&(r[n][s]=r[n][o]+r[o][s]);return r}getAdjacencyList(){let t=this.vertices.length,e=Array(t);for(var i=0;i<t;i++){e[i]=[];for(var r=0;r<t;r++)i!==r&&this.hasEdge(this.vertices[i].id,this.vertices[r].id)&&e[i].push(r)}return e}getSubgraphAdjacencyList(t){let e=t.length,i=Array(e);for(var r=0;r<e;r++){i[r]=Array();for(var n=0;n<e;n++)r!==n&&this.hasEdge(t[r],t[n])&&i[r].push(n)}return i}getBridges(){let t=this.vertices.length,e=new Array(t),i=new Array(t),r=new Array(t),n=new Array(t),s=this.getAdjacencyList(),o=Array();e.fill(!1),n.fill(null),this._time=0;for(var a=0;a<t;a++)e[a]||this._bridgeDfs(a,e,i,r,n,s,o);return o}traverseBF(t,e){let i=this.vertices.length,r=new Array(i);r.fill(!1);for(var n=[t];n.length>0;){let t=n.shift(),i=this.vertices[t];e(i);for(var s=0;s<i.neighbours.length;s++){let t=i.neighbours[s];r[t]||(r[t]=!0,n.push(t))}}}getTreeDepth(t,e){if(null===t||null===e)return 0;let i=this.vertices[t].getSpanningTreeNeighbours(e),r=0;for(var n=0;n<i.length;n++){let e=i[n],s=this.getTreeDepth(e,t);s>r&&(r=s)}return r+1}traverseTree(t,e,i,r=999999,n=!1,s=1,o=null){if(null===o&&(o=new Uint8Array(this.vertices.length)),s>r+1||1===o[t])return;o[t]=1;let a=this.vertices[t],h=a.getNeighbours(e);(!n||s>1)&&i(a);for(var l=0;l<h.length;l++)this.traverseTree(h[l],t,i,r,n,s+1,o)}kkLayout(t,e,i,n,s,o=.1,a=.1,h=2e3,l=50,g=1e9){let d=s;for(var u=t.length;u--;)var c=this.vertices[t[u]].neighbours.length;let p=this.getSubgraphDistanceMatrix(t),f=t.length,v=r.polyCircumradius(500,f),m=r.centralAngle(f),b=0,y=new Float32Array(f),S=new Float32Array(f),w=Array(f);for(u=f;u--;){let i=this.vertices[t[u]];i.positioned?(y[u]=i.position.x,S[u]=i.position.y):(y[u]=e.x+Math.cos(b)*v,S[u]=e.y+Math.sin(b)*v),w[u]=i.positioned,b+=m}let x=Array(f);for(u=f;u--;)for(x[u]=new Array(f),c=f;c--;)x[u][c]=s*p[u][c];let A=Array(f);for(u=f;u--;)for(A[u]=Array(f),c=f;c--;)A[u][c]=d*Math.pow(p[u][c],-2);let C,R,N,T,L,P,B,I=Array(f),E=new Float32Array(f),M=new Float32Array(f);for(u=f;u--;)I[u]=Array(f);for(u=f;u--;){C=y[u],R=S[u],N=0,T=0;let t=f;for(;t--;)u!==t&&(L=y[t],P=S[t],B=1/Math.sqrt((C-L)*(C-L)+(R-P)*(R-P)),I[u][t]=[A[u][t]*(C-L-x[u][t]*(C-L)*B),A[u][t]*(R-P-x[u][t]*(R-P)*B)],I[t][u]=I[u][t],N+=I[u][t][0],T+=I[u][t][1]);E[u]=N,M[u]=T}let k=function(t){return[E[t]*E[t]+M[t]*M[t],E[t],M[t]]},O=function(){let t=0,e=0,i=0,r=0;for(u=f;u--;){let[n,s,o]=k(u);n>t&&!1===w[u]&&(t=n,e=u,i=s,r=o)}return[e,t,i,r]},D=function(t,e,i){let r=0,n=0,s=0,o=y[t],a=S[t],h=x[t],l=A[t];for(u=f;u--;){if(u===t)continue;let e=y[u],i=S[u],g=h[u],d=l[u],c=(o-e)*(o-e),p=1/Math.pow(c+(a-i)*(a-i),1.5);r+=d*(1-g*(a-i)*(a-i)*p),n+=d*(1-g*c*p),s+=d*(g*(o-e)*(a-i)*p)}0===r&&(r=.1),0===n&&(n=.1),0===s&&(s=.1);let g=e/r+i/s;g/=s/r-n/s;let d=-(s*g+e)/r;y[t]+=d,S[t]+=g;let c,p,v,m,b,w=I[t];for(e=0,i=0,o=y[t],a=S[t],u=f;u--;)t!==u&&(c=y[u],p=S[u],v=w[u][0],m=w[u][1],b=1/Math.sqrt((o-c)*(o-c)+(a-p)*(a-p)),d=l[u]*(o-c-h[u]*(o-c)*b),g=l[u]*(a-p-h[u]*(a-p)*b),w[u]=[d,g],e+=d,i+=g,E[u]+=d-v,M[u]+=g-m);E[t]=e,M[t]=i},z=0,V=0,F=0,H=0,W=0,q=0;for(;g>o&&h>W;)for(W++,[z,g,V,F]=O(),H=g,q=0;H>a&&l>q;)q++,D(z,V,F),[H,V,F]=k(z);for(u=f;u--;){let e=t[u],i=this.vertices[e];i.position.x=y[u],i.position.y=S[u],i.positioned=!0,i.forcePositioned=!0}}_bridgeDfs(t,e,i,r,n,s,o){e[t]=!0,i[t]=r[t]=++this._time;for(var a=0;a<s[t].length;a++){let h=s[t][a];e[h]?h!==n[t]&&(r[t]=Math.min(r[t],i[h])):(n[h]=t,this._bridgeDfs(h,e,i,r,n,s,o),r[t]=Math.min(r[t],r[h]),r[h]>i[t]&&o.push([t,h]))}}static getConnectedComponents(t){let e=t.length,i=new Array(e),r=new Array;i.fill(!1);for(var n=0;n<e;n++)if(!i[n]){let e=Array();i[n]=!0,e.push(n),a._ccGetDfs(n,i,t,e),e.length>1&&r.push(e)}return r}static getConnectedComponentCount(t){let e=t.length,i=new Array(e),r=0;i.fill(!1);for(var n=0;n<e;n++)i[n]||(i[n]=!0,r++,a._ccCountDfs(n,i,t));return r}static _ccCountDfs(t,e,i){for(var r=0;r<i[t].length;r++)i[t][r]&&!e[r]&&t!==r&&(e[r]=!0,a._ccCountDfs(r,e,i))}static _ccGetDfs(t,e,i,r){for(var n=0;n<i[t].length;n++)i[t][n]&&!e[n]&&t!==n&&(e[n]=!0,r.push(n),a._ccGetDfs(n,e,i,r))}}t.exports=a},929:(t,e,i)=>{const r=i(614);class n{constructor(t=new r(0,0),e=new r(0,0),i=null,n=null,s=!1,o=!1){this.from=t,this.to=e,this.elementFrom=i,this.elementTo=n,this.chiralFrom=s,this.chiralTo=o}clone(){return new n(this.from.clone(),this.to.clone(),this.elementFrom,this.elementTo)}getLength(){return Math.sqrt(Math.pow(this.to.x-this.from.x,2)+Math.pow(this.to.y-this.from.y,2))}getAngle(){return r.subtract(this.getRightVector(),this.getLeftVector()).angle()}getRightVector(){return this.from.x<this.to.x?this.to:this.from}getLeftVector(){return this.from.x<this.to.x?this.from:this.to}getRightElement(){return this.from.x<this.to.x?this.elementTo:this.elementFrom}getLeftElement(){return this.from.x<this.to.x?this.elementFrom:this.elementTo}getRightChiral(){return this.from.x<this.to.x?this.chiralTo:this.chiralFrom}getLeftChiral(){return this.from.x<this.to.x?this.chiralFrom:this.chiralTo}setRightVector(t,e){return this.from.x<this.to.x?(this.to.x=t,this.to.y=e):(this.from.x=t,this.from.y=e),this}setLeftVector(t,e){return this.from.x<this.to.x?(this.from.x=t,this.from.y=e):(this.to.x=t,this.to.y=e),this}rotateToXAxis(){let t=this.getLeftVector();return this.setRightVector(t.x+this.getLength(),t.y),this}rotate(t){let e=this.getLeftVector(),i=this.getRightVector(),r=Math.sin(t),n=Math.cos(t),s=n*(i.x-e.x)-r*(i.y-e.y)+e.x,o=r*(i.x-e.x)-n*(i.y-e.y)+e.y;return this.setRightVector(s,o),this}shortenFrom(t){let e=r.subtract(this.to,this.from);return e.normalize(),e.multiplyScalar(t),this.from.add(e),this}shortenTo(t){let e=r.subtract(this.from,this.to);return e.normalize(),e.multiplyScalar(t),this.to.add(e),this}shortenRight(t){return this.from.x<this.to.x?this.shortenTo(t):this.shortenFrom(t),this}shortenLeft(t){return this.from.x<this.to.x?this.shortenFrom(t):this.shortenTo(t),this}shorten(t){let e=r.subtract(this.from,this.to);return e.normalize(),e.multiplyScalar(t/2),this.to.add(e),this.from.subtract(e),this}}t.exports=n},474:t=>{class e{static round(t,e){return e=e||1,Number(Math.round(t+"e"+e)+"e-"+e)}static meanAngle(t){let e=0,i=0;for(var r=0;r<t.length;r++)e+=Math.sin(t[r]),i+=Math.cos(t[r]);return Math.atan2(e/t.length,i/t.length)}static innerAngle(t){return e.toRad(180*(t-2)/t)}static polyCircumradius(t,e){return t/(2*Math.sin(Math.PI/e))}static apothem(t,e){return t*Math.cos(Math.PI/e)}static apothemFromSideLength(t,i){let r=e.polyCircumradius(t,i);return e.apothem(r,i)}static centralAngle(t){return e.toRad(360/t)}static toDeg(t){return t*e.degFactor}static toRad(t){return t*e.radFactor}static parityOfPermutation(t){let e=new Uint8Array(t.length),i=0,r=function(i,n=0){return 1===e[i]?n:(n++,e[i]=1,r(t[i],n))};for(var n=0;n<t.length;n++)1!==e[n]&&(i+=1-r(n)%2);return i%2?-1:1}static get radFactor(){return Math.PI/180}static get degFactor(){return 180/Math.PI}static get twoPI(){return 2*Math.PI}}t.exports=e},19:t=>{t.exports=function(){"use strict";function t(e,i,r,n){this.message=e,this.expected=i,this.found=r,this.location=n,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}return function(t,e){function i(){this.constructor=t}i.prototype=e.prototype,t.prototype=new i}(t,Error),t.buildMessage=function(t,e){var i={literal:function(t){return'"'+n(t.text)+'"'},class:function(t){var e,i="";for(e=0;e<t.parts.length;e++)i+=t.parts[e]instanceof Array?s(t.parts[e][0])+"-"+s(t.parts[e][1]):s(t.parts[e]);return"["+(t.inverted?"^":"")+i+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function n(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function s(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}return"Expected "+function(t){var e,r,n,s=new Array(t.length);for(e=0;e<t.length;e++)s[e]=(n=t[e],i[n.type](n));if(s.sort(),s.length>0){for(e=1,r=1;e<s.length;e++)s[e-1]!==s[e]&&(s[r]=s[e],r++);s.length=r}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(t)+" but "+function(t){return t?'"'+n(t)+'"':"end of input"}(e)+" found."},{SyntaxError:t,parse:function(e,i){if(i=void 0!==i?i:{},e.split("(").length-1!=e.split(")").length-1)throw at("The number of opening parentheses does not match the number of closing parentheses.",0);var r,n,s,o,a={},h={chain:ht},l=ht,g=it("(",!1),d=it(")",!1),u=/^[\-=#$:\/\\.]/,c=rt(["-","=","#","$",":","/","\\","."],!1,!1),p=it("[",!1),f=it("se",!1),v=it("as",!1),m=it("]",!1),b=it("B",!1),y=it("r",!1),S=it("C",!1),w=it("l",!1),x=/^[NOPSFI]/,A=rt(["N","O","P","S","F","I"],!1,!1),C=/^[bcnops]/,R=rt(["b","c","n","o","p","s"],!1,!1),N=it("*",!1),T=/^[A-Z]/,L=rt([["A","Z"]],!1,!1),P=/^[a-z]/,B=rt([["a","z"]],!1,!1),I=it("%",!1),E=/^[1-9]/,M=rt([["1","9"]],!1,!1),k=/^[0-9]/,O=rt([["0","9"]],!1,!1),D=it("@",!1),z=it("TH",!1),V=/^[12]/,F=rt(["1","2"],!1,!1),H=it("AL",!1),W=it("SP",!1),q=/^[1-3]/,j=rt([["1","3"]],!1,!1),U=it("TB",!1),X=it("OH",!1),_=it("+",!1),Y=it("-",!1),$=it("H",!1),G=it(":",!1),K=/^[0]/,Z=rt(["0"],!1,!1),J=0,Q=[{line:1,column:1}],tt=0,et=[];if("startRule"in i){if(!(i.startRule in h))throw new Error("Can't start parsing from rule \""+i.startRule+'".');l=h[i.startRule]}function it(t,e){return{type:"literal",text:t,ignoreCase:e}}function rt(t,e,i){return{type:"class",parts:t,inverted:e,ignoreCase:i}}function nt(t){var i,r=Q[t];if(r)return r;for(i=t-1;!Q[i];)i--;for(r={line:(r=Q[i]).line,column:r.column};i<t;)10===e.charCodeAt(i)?(r.line++,r.column=1):r.column++,i++;return Q[t]=r,r}function st(t,e){var i=nt(t),r=nt(e);return{start:{offset:t,line:i.line,column:i.column},end:{offset:e,line:r.line,column:r.column}}}function ot(t){J<tt||(J>tt&&(tt=J,et=[]),et.push(t))}function at(e,i){return new t(e,null,null,i)}function ht(){var t,i,r,n,s,o,h,l,g;if(J,t=J,(i=function(){var t;return J,(t=function(){var t,i,r,n;return J,t=J,66===e.charCodeAt(J)?(i="B",J++):(i=a,ot(b)),i!==a?(114===e.charCodeAt(J)?(r="r",J++):(r=a,ot(y)),r===a&&(r=null),r!==a?t=i=[i,r]:(J=t,t=a)):(J=t,t=a),t===a&&(t=J,67===e.charCodeAt(J)?(i="C",J++):(i=a,ot(S)),i!==a?(108===e.charCodeAt(J)?(r="l",J++):(r=a,ot(w)),r===a&&(r=null),r!==a?t=i=[i,r]:(J=t,t=a)):(J=t,t=a),t===a&&(x.test(e.charAt(J))?(t=e.charAt(J),J++):(t=a,ot(A)))),t!==a&&(t=(n=t).length>1?n.join(""):n),t}())===a&&(t=dt())===a&&(t=function(){var t,i,r,n,s,o,h,l,g,d;return J,t=J,91===e.charCodeAt(J)?(i="[",J++):(i=a,ot(p)),i!==a?((r=function(){var t,i,r,n;return J,t=J,E.test(e.charAt(J))?(i=e.charAt(J),J++):(i=a,ot(M)),i!==a?(k.test(e.charAt(J))?(r=e.charAt(J),J++):(r=a,ot(O)),r===a&&(r=null),r!==a?(k.test(e.charAt(J))?(n=e.charAt(J),J++):(n=a,ot(O)),n===a&&(n=null),n!==a?t=i=[i,r,n]:(J=t,t=a)):(J=t,t=a)):(J=t,t=a),t!==a&&(t=Number(t.join(""))),t}())===a&&(r=null),r!==a?("se"===e.substr(J,2)?(n="se",J+=2):(n=a,ot(f)),n===a&&("as"===e.substr(J,2)?(n="as",J+=2):(n=a,ot(v)),n===a&&(n=dt())===a&&(n=function(){var t,i,r;return J,t=J,T.test(e.charAt(J))?(i=e.charAt(J),J++):(i=a,ot(L)),i!==a?(P.test(e.charAt(J))?(r=e.charAt(J),J++):(r=a,ot(B)),r===a&&(r=null),r!==a?t=i=[i,r]:(J=t,t=a)):(J=t,t=a),t!==a&&(t=t.join("")),t}())===a&&(n=ut())),n!==a?((s=function(){var t,i,r,n,s,o,h;return J,t=J,64===e.charCodeAt(J)?(i="@",J++):(i=a,ot(D)),i!==a?(64===e.charCodeAt(J)?(r="@",J++):(r=a,ot(D)),r===a&&(r=J,"TH"===e.substr(J,2)?(n="TH",J+=2):(n=a,ot(z)),n!==a?(V.test(e.charAt(J))?(s=e.charAt(J),J++):(s=a,ot(F)),s!==a?r=n=[n,s]:(J=r,r=a)):(J=r,r=a),r===a&&(r=J,"AL"===e.substr(J,2)?(n="AL",J+=2):(n=a,ot(H)),n!==a?(V.test(e.charAt(J))?(s=e.charAt(J),J++):(s=a,ot(F)),s!==a?r=n=[n,s]:(J=r,r=a)):(J=r,r=a),r===a&&(r=J,"SP"===e.substr(J,2)?(n="SP",J+=2):(n=a,ot(W)),n!==a?(q.test(e.charAt(J))?(s=e.charAt(J),J++):(s=a,ot(j)),s!==a?r=n=[n,s]:(J=r,r=a)):(J=r,r=a),r===a&&(r=J,"TB"===e.substr(J,2)?(n="TB",J+=2):(n=a,ot(U)),n!==a?(E.test(e.charAt(J))?(s=e.charAt(J),J++):(s=a,ot(M)),s!==a?(k.test(e.charAt(J))?(o=e.charAt(J),J++):(o=a,ot(O)),o===a&&(o=null),o!==a?r=n=[n,s,o]:(J=r,r=a)):(J=r,r=a)):(J=r,r=a),r===a&&(r=J,"OH"===e.substr(J,2)?(n="OH",J+=2):(n=a,ot(X)),n!==a?(E.test(e.charAt(J))?(s=e.charAt(J),J++):(s=a,ot(M)),s!==a?(k.test(e.charAt(J))?(o=e.charAt(J),J++):(o=a,ot(O)),o===a&&(o=null),o!==a?r=n=[n,s,o]:(J=r,r=a)):(J=r,r=a)):(J=r,r=a)))))),r===a&&(r=null),r!==a?t=i=[i,r]:(J=t,t=a)):(J=t,t=a),t!==a&&(t=(h=t)[1]?"@"==h[1]?"@@":h[1].join("").replace(",",""):"@"),t}())===a&&(s=null),s!==a?((o=function(){var t,i,r,n;return J,t=J,72===e.charCodeAt(J)?(i="H",J++):(i=a,ot($)),i!==a?(k.test(e.charAt(J))?(r=e.charAt(J),J++):(r=a,ot(O)),r===a&&(r=null),r!==a?t=i=[i,r]:(J=t,t=a)):(J=t,t=a),t!==a&&(t=(n=t)[1]?Number(n[1]):1),t}())===a&&(o=null),o!==a?((h=function(){var t;return J,(t=function(){var t,i,r,n,s,o;return J,t=J,43===e.charCodeAt(J)?(i="+",J++):(i=a,ot(_)),i!==a?(43===e.charCodeAt(J)?(r="+",J++):(r=a,ot(_)),r===a&&(r=J,E.test(e.charAt(J))?(n=e.charAt(J),J++):(n=a,ot(M)),n!==a?(k.test(e.charAt(J))?(s=e.charAt(J),J++):(s=a,ot(O)),s===a&&(s=null),s!==a?r=n=[n,s]:(J=r,r=a)):(J=r,r=a)),r===a&&(r=null),r!==a?t=i=[i,r]:(J=t,t=a)):(J=t,t=a),t!==a&&(t=(o=t)[1]?"+"!=o[1]?Number(o[1].join("")):2:1),t}())===a&&(t=function(){var t,i,r,n,s,o;return J,t=J,45===e.charCodeAt(J)?(i="-",J++):(i=a,ot(Y)),i!==a?(45===e.charCodeAt(J)?(r="-",J++):(r=a,ot(Y)),r===a&&(r=J,E.test(e.charAt(J))?(n=e.charAt(J),J++):(n=a,ot(M)),n!==a?(k.test(e.charAt(J))?(s=e.charAt(J),J++):(s=a,ot(O)),s===a&&(s=null),s!==a?r=n=[n,s]:(J=r,r=a)):(J=r,r=a)),r===a&&(r=null),r!==a?t=i=[i,r]:(J=t,t=a)):(J=t,t=a),t!==a&&(t=(o=t)[1]?"-"!=o[1]?-Number(o[1].join("")):-2:-1),t}()),t!==a&&(t=t),t}())===a&&(h=null),h!==a?((l=function(){var t,i,r,n,s,o,h;if(J,t=J,58===e.charCodeAt(J)?(i=":",J++):(i=a,ot(G)),i!==a){if(r=J,E.test(e.charAt(J))?(n=e.charAt(J),J++):(n=a,ot(M)),n!==a){for(s=[],k.test(e.charAt(J))?(o=e.charAt(J),J++):(o=a,ot(O));o!==a;)s.push(o),k.test(e.charAt(J))?(o=e.charAt(J),J++):(o=a,ot(O));s!==a?r=n=[n,s]:(J=r,r=a)}else J=r,r=a;r===a&&(K.test(e.charAt(J))?(r=e.charAt(J),J++):(r=a,ot(Z))),r!==a?t=i=[i,r]:(J=t,t=a)}else J=t,t=a;return t!==a&&(h=t,t=Number(h[1][0]+h[1][1].join(""))),t}())===a&&(l=null),l!==a?(93===e.charCodeAt(J)?(g="]",J++):(g=a,ot(m)),g!==a?t=i=[i,r,n,s,o,h,l,g]:(J=t,t=a)):(J=t,t=a)):(J=t,t=a)):(J=t,t=a)):(J=t,t=a)):(J=t,t=a)):(J=t,t=a)):(J=t,t=a),t!==a&&(t={isotope:(d=t)[1],element:d[2],chirality:d[3],hcount:d[4],charge:d[5],class:d[6]}),t}())===a&&(t=ut()),t!==a&&(t=t),t}())!==a){for(r=[],n=lt();n!==a;)r.push(n),n=lt();if(r!==a){for(n=[],s=J,(o=gt())===a&&(o=null),o!==a&&(h=ct())!==a?s=o=[o,h]:(J=s,s=a);s!==a;)n.push(s),s=J,(o=gt())===a&&(o=null),o!==a&&(h=ct())!==a?s=o=[o,h]:(J=s,s=a);if(n!==a){for(s=[],o=lt();o!==a;)s.push(o),o=lt();if(s!==a)if((o=gt())===a&&(o=null),o!==a)if((h=ht())===a&&(h=null),h!==a){for(l=[],g=lt();g!==a;)l.push(g),g=lt();l!==a?t=i=[i,r,n,s,o,h,l]:(J=t,t=a)}else J=t,t=a;else J=t,t=a;else J=t,t=a}else J=t,t=a}else J=t,t=a}else J=t,t=a;return t!==a&&(t=function(t){for(var e=[],i=[],r=0;r<t[1].length;r++)e.push(t[1][r]);for(r=0;r<t[2].length;r++){var n=t[2][r][0]?t[2][r][0]:"-";i.push({bond:n,id:t[2][r][1]})}for(r=0;r<t[3].length;r++)e.push(t[3][r]);for(r=0;r<t[6].length;r++)e.push(t[6][r]);return{atom:t[0],isBracket:!!t[0].element,branches:e,branchCount:e.length,ringbonds:i,ringbondCount:i.length,bond:t[4]?t[4]:"-",next:t[5],hasNext:!!t[5]}}(t)),t}function lt(){var t,i,r,n,s,o,h;return J,t=J,40===e.charCodeAt(J)?(i="(",J++):(i=a,ot(g)),i!==a?((r=gt())===a&&(r=null),r!==a&&(n=ht())!==a?(41===e.charCodeAt(J)?(s=")",J++):(s=a,ot(d)),s!==a?t=i=[i,r,n,s]:(J=t,t=a)):(J=t,t=a)):(J=t,t=a),t!==a&&(h=(o=t)[1]?o[1]:"-",o[2].branchBond=h,t=o[2]),t}function gt(){var t;if(J,u.test(e.charAt(J))){if((t=e.charAt(J))===e.charAt(J+1))throw t=a,at("The parser encountered a bond repetition.",J+1);J++}else t=a,ot(c);return t!==a&&(t=t),t}function dt(){var t;return J,C.test(e.charAt(J))?(t=e.charAt(J),J++):(t=a,ot(R)),t!==a&&(t=t),t}function ut(){var t;return J,42===e.charCodeAt(J)?(t="*",J++):(t=a,ot(N)),t!==a&&(t=t),t}function ct(){var t,i,r,n,s;return J,t=J,37===e.charCodeAt(J)?(i="%",J++):(i=a,ot(I)),i!==a?(E.test(e.charAt(J))?(r=e.charAt(J),J++):(r=a,ot(M)),r!==a?(k.test(e.charAt(J))?(n=e.charAt(J),J++):(n=a,ot(O)),n!==a?t=i=[i,r,n]:(J=t,t=a)):(J=t,t=a)):(J=t,t=a),t===a&&(k.test(e.charAt(J))?(t=e.charAt(J),J++):(t=a,ot(O))),t!==a&&(t=1==(s=t).length?Number(s):Number(s.join("").replace("%",""))),t}if((r=l())!==a&&J===e.length)return r;throw r!==a&&J<e.length&&ot({type:"end"}),n=et,s=tt<e.length?e.charAt(tt):null,o=tt<e.length?st(tt,tt+1):st(tt,tt),new t(t.buildMessage(n,s),n,s,o)}}}()},421:(t,e,i)=>{const r=i(348),n=i(614),s=(i(843),i(333));class o{constructor(t){this.id=null,this.members=t,this.edges=[],this.insiders=[],this.neighbours=[],this.positioned=!1,this.center=new n(0,0),this.rings=[],this.isBridged=!1,this.isPartOfBridged=!1,this.isSpiro=!1,this.isFused=!1,this.centralAngle=0,this.canFlip=!0}clone(){let t=new o(this.members);return t.id=this.id,t.insiders=r.clone(this.insiders),t.neighbours=r.clone(this.neighbours),t.positioned=this.positioned,t.center=this.center.clone(),t.rings=r.clone(this.rings),t.isBridged=this.isBridged,t.isPartOfBridged=this.isPartOfBridged,t.isSpiro=this.isSpiro,t.isFused=this.isFused,t.centralAngle=this.centralAngle,t.canFlip=this.canFlip,t}getSize(){return this.members.length}getPolygon(t){let e=[];for(let i=0;i<this.members.length;i++)e.push(t[this.members[i]].position);return e}getAngle(){return Math.PI-this.centralAngle}eachMember(t,e,i,r){let n=i=i||0===i?i:this.members[0],s=0;for(;null!=n&&s<100;){let o=n;e(o),n=t[n].getNextInRing(t,this.id,r),r=o,n==i&&(n=null),s++}}getOrderedNeighbours(t){let e=Array(this.neighbours.length);for(let i=0;i<this.neighbours.length;i++){let r=s.getVertices(t,this.id,this.neighbours[i]);e[i]={n:r.length,neighbour:this.neighbours[i]}}return e.sort((function(t,e){return e.n-t.n})),e}isBenzeneLike(t){let e=this.getDoubleBondCount(t),i=this.members.length;return 3===e&&6===i||2===e&&5===i}getDoubleBondCount(t){let e=0;for(let i=0;i<this.members.length;i++){let r=t[this.members[i]].value;"="!==r.bondType&&"="!==r.branchBond||e++}return e}contains(t){for(let e=0;e<this.members.length;e++)if(this.members[e]==t)return!0;return!1}}t.exports=o},333:(t,e,i)=>{i(843),i(421),t.exports=class{constructor(t,e){this.id=null,this.firstRingId=t.id,this.secondRingId=e.id,this.vertices=new Set;for(var i=0;i<t.members.length;i++){let r=t.members[i];for(let t=0;t<e.members.length;t++)r===e.members[t]&&this.addVertex(r)}}addVertex(t){this.vertices.add(t)}updateOther(t,e){this.firstRingId===e?this.secondRingId=t:this.firstRingId=t}containsRing(t){return this.firstRingId===t||this.secondRingId===t}isBridge(t){if(this.vertices.size>2)return!0;for(let e of this.vertices)if(t[e].value.rings.length>2)return!0;return!1}static isBridge(t,e,i,r){let n=null;for(let s=0;s<t.length;s++)if(n=t[s],n.firstRingId===i&&n.secondRingId===r||n.firstRingId===r&&n.secondRingId===i)return n.isBridge(e);return!1}static getNeighbours(t,e){let i=[];for(let r=0;r<t.length;r++){let n=t[r];n.firstRingId===e?i.push(n.secondRingId):n.secondRingId===e&&i.push(n.firstRingId)}return i}static getVertices(t,e,i){for(let r=0;r<t.length;r++){let n=t[r];if(n.firstRingId===e&&n.secondRingId===i||n.firstRingId===i&&n.secondRingId===e)return[...n.vertices]}}}},473:(t,e,i)=>{const r=i(707);class n{static getRings(t,e=!1){let i=t.getComponentsAdjacencyMatrix();if(0===i.length)return null;let s=r.getConnectedComponents(i),o=Array();for(var a=0;a<s.length;a++){let i=s[a],r=t.getSubgraphAdjacencyMatrix([...i]),g=new Uint16Array(r.length),d=new Uint16Array(r.length);for(var h=0;h<r.length;h++){d[h]=0,g[h]=0;for(var l=0;l<r[h].length;l++)g[h]+=r[h][l]}let u=0;for(h=0;h<r.length;h++)for(l=h+1;l<r.length;l++)u+=r[h][l];let c=u-r.length+1,p=!0;for(h=0;h<g.length;h++)3!==g[h]&&(p=!1);if(p&&(c=2+u-r.length),1===c){o.push([...i]);continue}e&&(c=999);let{d:f,pe:v,pe_prime:m}=n.getPathIncludedDistanceMatrices(r),b=n.getRingCandidates(f,v,m),y=n.getSSSR(b,f,r,v,m,g,d,c);for(h=0;h<y.length;h++){let t=Array(y[h].size),e=0;for(let r of y[h])t[e++]=i[r];o.push(t)}}return o}static matrixToString(t){let e="";for(var i=0;i<t.length;i++){for(var r=0;r<t[i].length;r++)e+=t[i][r]+" ";e+="\n"}return e}static getPathIncludedDistanceMatrices(t){let e=t.length,i=Array(e),r=Array(e),n=Array(e);for(var s=0,o=0,a=0,h=e;h--;){i[h]=Array(e),r[h]=Array(e),n[h]=Array(e);for(var l=e;l--;)i[h][l]=h===l||1===t[h][l]?t[h][l]:Number.POSITIVE_INFINITY,1===i[h][l]?r[h][l]=[[[h,l]]]:r[h][l]=Array(),n[h][l]=Array()}for(var g=e;g--;)for(h=e;h--;)for(l=e;l--;){const t=i[h][l],e=i[h][g]+i[g][l];if(t>e){if(t===e+1)for(n[h][l]=[r[h][l].length],s=r[h][l].length;s--;)for(n[h][l][s]=[r[h][l][s].length],o=r[h][l][s].length;o--;)for(n[h][l][s][o]=[r[h][l][s][o].length],a=r[h][l][s][o].length;a--;)n[h][l][s][o][a]=[r[h][l][s][o][0],r[h][l][s][o][1]];else n[h][l]=Array();for(i[h][l]=e,r[h][l]=[[]],s=r[h][g][0].length;s--;)r[h][l][0].push(r[h][g][0][s]);for(s=r[g][l][0].length;s--;)r[h][l][0].push(r[g][l][0][s])}else if(t===e){if(r[h][g].length&&r[g][l].length)if(r[h][l].length){let t=Array();for(s=r[h][g][0].length;s--;)t.push(r[h][g][0][s]);for(s=r[g][l][0].length;s--;)t.push(r[g][l][0][s]);r[h][l].push(t)}else{let t=Array();for(s=r[h][g][0].length;s--;)t.push(r[h][g][0][s]);for(s=r[g][l][0].length;s--;)t.push(r[g][l][0][s]);r[h][l][0]=t}}else if(t===e-1)if(n[h][l].length){let t=Array();for(s=r[h][g][0].length;s--;)t.push(r[h][g][0][s]);for(s=r[g][l][0].length;s--;)t.push(r[g][l][0][s]);n[h][l].push(t)}else{let t=Array();for(s=r[h][g][0].length;s--;)t.push(r[h][g][0][s]);for(s=r[g][l][0].length;s--;)t.push(r[g][l][0][s]);n[h][l][0]=t}}return{d:i,pe:r,pe_prime:n}}static getRingCandidates(t,e,i){let r=t.length,n=Array(),s=0;for(let o=0;o<r;o++)for(let a=0;a<r;a++)0===t[o][a]||1===e[o][a].length&&0===i[o][a]||(s=0!==i[o][a].length?2*(t[o][a]+.5):2*t[o][a],s!==1/0&&n.push([s,e[o][a],i[o][a]]));return n.sort((function(t,e){return t[0]-e[0]})),n}static getSSSR(t,e,i,r,s,o,a,h){let l=Array(),g=Array();for(let e=0;e<t.length;e++)if(t[e][0]%2!=0)for(let r=0;r<t[e][2].length;r++){let s=t[e][1][0].concat(t[e][2][r]);for(var d=0;d<s.length;d++)s[d][0].constructor===Array&&(s[d]=s[d][0]);let u=n.bondsToAtoms(s);if(n.getBondCount(u,i)!==u.size||n.pathSetsContain(l,u,s,g,o,a)||(l.push(u),g=g.concat(s)),l.length>h)return l}else for(let r=0;r<t[e][1].length-1;r++){let s=t[e][1][r].concat(t[e][1][r+1]);for(d=0;d<s.length;d++)s[d][0].constructor===Array&&(s[d]=s[d][0]);let u=n.bondsToAtoms(s);if(n.getBondCount(u,i)!==u.size||n.pathSetsContain(l,u,s,g,o,a)||(l.push(u),g=g.concat(s)),l.length>h)return l}return l}static getEdgeCount(t){let e=0,i=t.length;for(var r=i-1;r--;)for(var n=i;n--;)1===t[r][n]&&e++;return e}static getEdgeList(t){let e=t.length,i=Array();for(var r=e-1;r--;)for(var n=e;n--;)1===t[r][n]&&i.push([r,n]);return i}static bondsToAtoms(t){let e=new Set;for(var i=t.length;i--;)e.add(t[i][0]),e.add(t[i][1]);return e}static getBondCount(t,e){let i=0;for(let r of t)for(let n of t)r!==n&&(i+=e[r][n]);return i/2}static pathSetsContain(t,e,i,r,s,o){for(var a=t.length;a--;){if(n.isSupersetOf(e,t[a]))return!0;if(t[a].size===e.size&&n.areSetsEqual(t[a],e))return!0}let h=0,l=!1;for(a=i.length;a--;)for(var g=r.length;g--;)(i[a][0]===r[g][0]&&i[a][1]===r[g][1]||i[a][1]===r[g][0]&&i[a][0]===r[g][1])&&h++,h===i.length&&(l=!0);let d=!1;if(l)for(let t of e)if(o[t]<s[t]){d=!0;break}if(l&&!d)return!0;for(let t of e)o[t]++;return!1}static areSetsEqual(t,e){if(t.size!==e.size)return!1;for(let i of t)if(!e.has(i))return!1;return!0}static isSupersetOf(t,e){for(var i of e)if(!t.has(i))return!1;return!0}}t.exports=n},479:(t,e,i)=>{const r=i(348),n=i(427),s=i(881),o=(i(707),i(929)),a=i(36),h=i(654),l=i(614);t.exports=class{constructor(t){this.preprocessor=new s(t)}draw(t,e,i="light",r=!1){let n=this.preprocessor;return n.initDraw(t,i,r),r||(this.themeManager=new h(this.preprocessor.opts.themes,i),this.svgWrapper=new a(this.themeManager,e,this.preprocessor.opts)),n.processGraph(),this.svgWrapper.determineDimensions(n.graph.vertices),this.drawEdges(n.opts.debug),this.drawVertices(n.opts.debug),n.opts.debug&&(console.log(n.graph),console.log(n.rings),console.log(n.ringConnections)),this.svgWrapper.constructSvg()}drawAromaticityRing(t){let e=this.ctx,i=MathHelper.apothemFromSideLength(this.opts.bondLength,t.getSize());e.save(),e.strokeStyle=this.getColor("C"),e.lineWidth=this.opts.bondThickness,e.beginPath(),e.arc(t.center.x+this.offsetX,t.center.y+this.offsetY,i-this.opts.bondSpacing,0,2*Math.PI,!0),e.closePath(),e.stroke(),e.restore()}drawEdges(t){let e=this.preprocessor,i=e.graph,r=e.rings,n=Array(this.preprocessor.graph.edges.length);if(n.fill(!1),i.traverseBF(0,(e=>{let r=i.getEdges(e.id);for(var s=0;s<r.length;s++){let e=r[s];n[e]||(n[e]=!0,this.drawEdge(e,t))}})),!this.bridgedRing)for(var s=0;s<r.length;s++){let t=r[s];e.isRingAromatic(t)&&this.drawAromaticityRing(t)}}drawEdge(t,e){let i=this.preprocessor,n=i.opts,s=this.svgWrapper,a=i.graph.edges[t],h=i.graph.vertices[a.sourceId],g=i.graph.vertices[a.targetId],d=h.value.element,u=g.value.element;if(!(h.value.isDrawn&&g.value.isDrawn||"default"!==i.opts.atomVisualization))return;let c=h.position,p=g.position,f=i.getEdgeNormals(a),v=r.clone(f);if(v[0].multiplyScalar(10).add(c),v[1].multiplyScalar(10).add(c),"="===a.bondType||"="===i.getRingbondType(h,g)||a.isPartOfAromaticRing&&i.bridgedRing){let t=i.areVerticesInSameRing(h,g),e=i.chooseSide(h,g,v);if(t){let t=i.getLargestOrAromaticCommonRing(h,g).center;f[0].multiplyScalar(n.bondSpacing),f[1].multiplyScalar(n.bondSpacing);let e=null;e=t.sameSideAs(h.position,g.position,l.add(c,f[0]))?new o(l.add(c,f[0]),l.add(p,f[0]),d,u):new o(l.add(c,f[1]),l.add(p,f[1]),d,u),e.shorten(n.bondLength-n.shortBondLength*n.bondLength),a.isPartOfAromaticRing?s.drawLine(e,!0):s.drawLine(e),s.drawLine(new o(c,p,d,u))}else if(a.center||h.isTerminal()&&g.isTerminal()||0==e.anCount&&e.bnCount>1||0==e.bnCount&&e.anCount>1){this.multiplyNormals(f,n.halfBondSpacing);let t=new o(l.add(c,f[0]),l.add(p,f[0]),d,u),e=new o(l.add(c,f[1]),l.add(p,f[1]),d,u);s.drawLine(t),s.drawLine(e)}else if(e.sideCount[0]>e.sideCount[1]||e.totalSideCount[0]>e.totalSideCount[1]){this.multiplyNormals(f,n.bondSpacing);let t=new o(l.add(c,f[0]),l.add(p,f[0]),d,u);t.shorten(n.bondLength-n.shortBondLength*n.bondLength),s.drawLine(t),s.drawLine(new o(c,p,d,u))}else if(e.sideCount[0]<e.sideCount[1]||e.totalSideCount[0]<=e.totalSideCount[1]){this.multiplyNormals(f,n.bondSpacing);let t=new o(l.add(c,f[1]),l.add(p,f[1]),d,u);t.shorten(n.bondLength-n.shortBondLength*n.bondLength),s.drawLine(t),s.drawLine(new o(c,p,d,u))}}else if("#"===a.bondType){f[0].multiplyScalar(n.bondSpacing/1.5),f[1].multiplyScalar(n.bondSpacing/1.5);let t=new o(l.add(c,f[0]),l.add(p,f[0]),d,u),e=new o(l.add(c,f[1]),l.add(p,f[1]),d,u);s.drawLine(t),s.drawLine(e),s.drawLine(new o(c,p,d,u))}else if("."===a.bondType);else{let t=h.value.isStereoCenter,e=g.value.isStereoCenter;"up"===a.wedge?s.drawWedge(new o(c,p,d,u,t,e)):"down"===a.wedge?s.drawDashedWedge(new o(c,p,d,u,t,e)):s.drawLine(new o(c,p,d,u,t,e))}if(e){let e=l.midpoint(c,p);s.drawDebugText(e.x,e.y,"e: "+t)}}drawVertices(t){let e=this.preprocessor,i=e.opts,s=e.graph,o=e.rings,a=this.svgWrapper;var h=s.vertices.length;for(h=0;h<s.vertices.length;h++){let e=s.vertices[h],o=e.value,g=0,d=0,u=e.value.bondCount,c=o.element,p=n.maxBonds[c]-u,f=e.getTextDirection(s.vertices),v=!(!i.terminalCarbons&&"C"===c&&!o.hasAttachedPseudoElements)&&e.isTerminal(),m="C"===o.element;if("N"===o.element&&o.isPartOfAromaticRing&&(p=0),o.bracket&&(p=o.bracket.hcount,g=o.bracket.charge,d=o.bracket.isotope),"allballs"===i.atomVisualization)a.drawBall(e.position.x,e.position.y,c);else if(o.isDrawn&&(!m||o.drawExplicit||v||o.hasAttachedPseudoElements)||1===s.vertices.length)"default"===i.atomVisualization?a.drawText(e.position.x,e.position.y,c,p,f,v,g,d,o.getAttachedPseudoElements()):"balls"===i.atomVisualization&&a.drawBall(e.position.x,e.position.y,c);else if(2===e.getNeighbourCount()&&1==e.forcePositioned){let t=s.vertices[e.neighbours[0]].position,i=s.vertices[e.neighbours[1]].position,r=l.threePointangle(e.position,t,i);Math.abs(Math.PI-r)<.1&&a.drawPoint(e.position.x,e.position.y,c)}if(t){let t="v: "+e.id+" "+r.print(o.ringbonds);a.drawDebugText(e.position.x,e.position.y,t)}else a.drawDebugText(e.position.x,e.position.y,e.value.chirality)}if(i.debug)for(h=0;h<o.length;h++){let t=o[h].center;a.drawDebugPoint(t.x,t.y,"r: "+o[h].id)}}getTotalOverlapScore(){return this.preprocessor.getTotalOverlapScore()}getMolecularFormula(){return this.preprocessor.getMolecularFormula()}multiplyNormals(t,e){t[0].multiplyScalar(e),t[1].multiplyScalar(e)}}},36:(t,e,i)=>{const{getChargeText:r}=i(537),n=i(929),s=i(614);t.exports=class{constructor(t,e,i){this.svg=document.getElementById(e),this.opts=i,this.gradientId=0,this.paths=[],this.vertices=[],this.gradients=[],this.offsetX=0,this.offsetY=0,this.drawingWidth=0,this.drawingHeight=0,this.halfBondThickness=this.opts.bondThickness/2,this.themeManager=t,this.maskElements=[];let r=document.createElementNS("http://www.w3.org/2000/svg","rect");for(r.setAttributeNS(null,"x",0),r.setAttributeNS(null,"y",0),r.setAttributeNS(null,"width","100%"),r.setAttributeNS(null,"height","100%"),r.setAttributeNS(null,"fill","white"),this.maskElements.push(r);this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild)}constructSvg(){let t=document.createElementNS("http://www.w3.org/2000/svg","defs"),e=document.createElementNS("http://www.w3.org/2000/svg","mask"),i=document.createElementNS("http://www.w3.org/2000/svg","style"),r=document.createElementNS("http://www.w3.org/2000/svg","g"),n=document.createElementNS("http://www.w3.org/2000/svg","g"),s=this.paths;e.setAttributeNS(null,"id","text-mask"),i.appendChild(document.createTextNode(`\n                .element {\n                    font: ${this.opts.fontSizeLarge}pt Helvetica, Arial, sans-serif;\n                    alignment-baseline: 'middle';\n                }\n                .sub {\n                    font: ${this.opts.fontSizeSmall}pt Helvetica, Arial, sans-serif;\n                }\n            `));for(let t of s)r.appendChild(t);for(let t of this.vertices)n.appendChild(t);for(let t of this.maskElements)e.appendChild(t);for(let e of this.gradients)t.appendChild(e);if(r.setAttributeNS(null,"mask","url(#text-mask)"),this.svg)return this.svg.appendChild(t),this.svg.appendChild(e),this.svg.appendChild(i),this.svg.appendChild(r),this.svg.appendChild(n),this.svg;{let s=document.createElementNS("http://www.w3.org/2000/svg","g");return s.appendChild(t),s.appendChild(e),s.appendChild(i),s.appendChild(r),s.appendChild(n),s}}createGradient(t){let e=document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),i="line-"+this.gradientId++,r=t.getLeftVector(),n=t.getRightVector(),s=r.x+this.offsetX,o=r.y+this.offsetY,a=n.x+this.offsetX,h=n.y+this.offsetY;e.setAttributeNS(null,"id",i),e.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),e.setAttributeNS(null,"x1",s),e.setAttributeNS(null,"y1",o),e.setAttributeNS(null,"x2",a),e.setAttributeNS(null,"y2",h);let l=document.createElementNS("http://www.w3.org/2000/svg","stop");l.setAttributeNS(null,"stop-color",this.themeManager.getColor(t.getLeftElement())||this.themeManager.getColor("C")),l.setAttributeNS(null,"offset","20%");let g=document.createElementNS("http://www.w3.org/2000/svg","stop");return g.setAttributeNS(null,"stop-color",this.themeManager.getColor(t.getRightElement()||this.themeManager.getColor("C"))),g.setAttributeNS(null,"offset","100%"),e.appendChild(l),e.appendChild(g),this.gradients.push(e),i}createSubSuperScripts(t,e){let i=document.createElementNS("http://www.w3.org/2000/svg","tspan");return i.setAttributeNS(null,"baseline-shift",e),i.appendChild(document.createTextNode(t)),i.setAttributeNS(null,"class","sub"),i}determineDimensions(t){let e=-Number.MAX_VALUE,i=-Number.MAX_VALUE,r=Number.MAX_VALUE,n=Number.MAX_VALUE;for(var s=0;s<t.length;s++){if(!t[s].value.isDrawn)continue;let o=t[s].position;e<o.x&&(e=o.x),i<o.y&&(i=o.y),r>o.x&&(r=o.x),n>o.y&&(n=o.y)}let o=this.opts.padding;e+=o,i+=o,r-=o,n-=o,this.drawingWidth=e-r,this.drawingHeight=i-n;let a=this.svg.clientWidth/this.drawingWidth,h=this.svg.clientHeight/this.drawingHeight,l=a<h?a:h,g=Math.round(this.drawingWidth>this.drawingHeight?this.drawingWidth:this.drawingHeight);this.svg.setAttributeNS(null,"viewBox",`0 0 ${g} ${g}`),this.offsetX=-r,this.offsetY=-n,a<h?this.offsetY+=this.svg.clientHeight/(2*l)-this.drawingHeight/2:this.offsetX+=this.svg.clientWidth/(2*l)-this.drawingWidth/2}drawBall(t,e,i){let r=document.createElementNS("http://www.w3.org/2000/svg","circle");r.setAttributeNS(null,"cx",t+this.offsetX),r.setAttributeNS(null,"cy",e+this.offsetY),r.setAttributeNS(null,"r",this.opts.bondLength/4.5),r.setAttributeNS(null,"fill",this.themeManager.getColor(i)),this.vertices.push(r)}drawDashedWedge(t){if(isNaN(t.from.x)||isNaN(t.from.y)||isNaN(t.to.x)||isNaN(t.to.y))return;this.offsetX,this.offsetY;let e,i,r=t.getLeftVector().clone(),o=t.getRightVector().clone(),a=s.normals(r,o);a[0].normalize(),a[1].normalize(),t.getRightChiral()?(e=o,i=r):(e=r,i=o);let h=s.subtract(i,e).normalize(),l=t.getLength(),g=1.25/(l/(3*this.opts.bondThickness)),d=this.createGradient(t);for(let t=0;t<1;t+=g){let i=s.multiplyScalar(h,t*l),r=s.add(e,i),o=1.5*t,g=s.multiplyScalar(a[0],o);r.subtract(g);let u=r.clone();u.add(s.multiplyScalar(g,2)),this.drawLine(new n(r,u),null,d)}}drawDebugPoint(t,e,i="",r="#f00"){let n=document.createElementNS("http://www.w3.org/2000/svg","circle");n.setAttributeNS(null,"cx",t+this.offsetX),n.setAttributeNS(null,"cy",e+this.offsetY),n.setAttributeNS(null,"r","2"),n.setAttributeNS(null,"fill","#f00"),this.vertices.push(n),this.drawDebugText(t,e,i)}drawDebugText(t,e,i){let r=document.createElementNS("http://www.w3.org/2000/svg","text");r.setAttributeNS(null,"x",t+this.offsetX),r.setAttributeNS(null,"y",e+this.offsetY),r.setAttributeNS(null,"class","debug"),r.setAttributeNS(null,"fill","#ff0000"),r.setAttributeNS(null,"style","\n                font: 5px Droid Sans, sans-serif;\n            "),r.appendChild(document.createTextNode(i)),this.vertices.push(r)}drawLine(t,e=!1,i=null){this.opts;let r=[["stroke-linecap","round"],["stroke-dasharray",e?"5, 5":"none"]],n=t.getLeftVector(),s=t.getRightVector(),o=n.x+this.offsetX,a=n.y+this.offsetY,h=s.x+this.offsetX,l=s.y+this.offsetY,g=r.map((t=>t.join(":"))).join(";"),d=document.createElementNS("http://www.w3.org/2000/svg","line");d.setAttributeNS(null,"x1",o),d.setAttributeNS(null,"y1",a),d.setAttributeNS(null,"x2",h),d.setAttributeNS(null,"y2",l),d.setAttributeNS(null,"style",g),this.paths.push(d),null==i&&(i=this.createGradient(t,o,a,h,l)),d.setAttributeNS(null,"stroke",`url('#${i}')`)}drawPoint(t,e,i){this.ctx;let r=this.offsetX,n=this.offsetY,s=document.createElementNS("http://www.w3.org/2000/svg","circle");s.setAttributeNS(null,"cx",t+r),s.setAttributeNS(null,"cy",e+n),s.setAttributeNS(null,"r","1.5"),s.setAttributeNS(null,"fill","black"),this.maskElements.push(s);let o=document.createElementNS("http://www.w3.org/2000/svg","circle");o.setAttributeNS(null,"cx",t+r),o.setAttributeNS(null,"cy",e+n),o.setAttributeNS(null,"r","0.75"),o.setAttributeNS(null,"fill",this.themeManager.getColor(i)),this.vertices.push(o)}drawText(t,e,i,n,s,o,a,h,l={}){let g={x:t+this.offsetX,y:e+this.offsetY},d=document.createElementNS("http://www.w3.org/2000/svg","text"),u="horizontal-tb",c="normal",p="mixed",f="direction: ltr;",v=-2,m=2.5,b=document.createElementNS("http://www.w3.org/2000/svg","circle");b.setAttributeNS(null,"cx",g.x),b.setAttributeNS(null,"cy",g.y),b.setAttributeNS(null,"r","3.5"),b.setAttributeNS(null,"fill","black"),this.maskElements.push(b),/up|down/.test(s)&&!o&&(u="vertical-rl",p="upright",c="-1px"),"down"!==s||o?"up"!==s||o?"left"===s&&(v=2):v=.5:(v=0,m=-2),("left"===s||"up"===s&&!o)&&(f="direction: rtl; unicode-bidi: bidi-override;"),d.setAttributeNS(null,"x",g.x+v),d.setAttributeNS(null,"y",g.y+m),d.setAttributeNS(null,"class","element"),d.setAttributeNS(null,"fill",this.themeManager.getColor(i)),d.setAttributeNS(null,"style",`\n                text-anchor: start;\n                writing-mode: ${u};\n                text-orientation: ${p};\n                letter-spacing: ${c};\n                ${f}\n            `);let y=document.createElementNS("http://www.w3.org/2000/svg","tspan");if(i.length>1){let t=/up|down/.test(s)?"middle":"start";y.setAttributeNS(null,"style",`\n                unicode-bidi: plaintext;\n                writing-mode: lr-tb;\n                letter-spacing: normal;\n                text-anchor: ${t};\n            `)}if(y.appendChild(document.createTextNode(i)),d.appendChild(y),a){let t=this.createSubSuperScripts(r(a),"super");y.appendChild(t)}if(h>0){let t=this.createSubSuperScripts(h.toString(),"super");y.appendChild(t)}if(1===a&&"N"===i&&l.hasOwnProperty("0O")&&l.hasOwnProperty("0O-1")&&(l={"0O":{element:"O",count:2,hydrogenCount:0,previousElement:"C",charge:""}},a=0),n>0){let t=document.createElementNS("http://www.w3.org/2000/svg","tspan");if(t.setAttributeNS(null,"style","unicode-bidi: plaintext;"),t.appendChild(document.createTextNode("H")),d.appendChild(t),n>1){let e=this.createSubSuperScripts(n,"sub");t.appendChild(e)}}for(let t in l){if(!l.hasOwnProperty(t))continue;let e=l[t].element,i=l[t].count,n=l[t].hydrogenCount,s=l[t].charge,o=document.createElementNS("http://www.w3.org/2000/svg","tspan");if(o.setAttributeNS(null,"style","unicode-bidi: plaintext;"),o.appendChild(document.createTextNode(e)),o.setAttributeNS(null,"fill",this.themeManager.getColor(e)),0!==s){let t=this.createSubSuperScripts(r(s),"super");o.appendChild(t)}if(n>0){let t=document.createElementNS("http://www.w3.org/2000/svg","tspan");if(t.setAttributeNS(null,"style","unicode-bidi: plaintext;"),t.appendChild(document.createTextNode("H")),o.appendChild(t),n>1){let e=this.createSubSuperScripts(n,"sub");t.appendChild(e)}}if(i>1){let t=this.createSubSuperScripts(i,"sub");o.appendChild(t)}d.appendChild(o)}this.vertices.push(d)}drawWedge(t){let e=this.offsetX,i=this.offsetY,r=t.getLeftVector().clone(),n=t.getRightVector().clone();r.x+=e,r.y+=i,n.x+=e,n.y+=i;let o=s.normals(r,n);o[0].normalize(),o[1].normalize();let a=r,h=n;t.getRightChiral()&&(a=n,h=r);let l=s.add(a,s.multiplyScalar(o[0],this.halfBondThickness)),g=s.add(h,s.multiplyScalar(o[0],1.5+this.halfBondThickness)),d=s.add(h,s.multiplyScalar(o[1],1.5+this.halfBondThickness)),u=s.add(a,s.multiplyScalar(o[1],this.halfBondThickness)),c=document.createElementNS("http://www.w3.org/2000/svg","polygon"),p=this.createGradient(t,r.x,r.y,n.x,n.y);c.setAttributeNS(null,"points",`${l.x},${l.y} ${g.x},${g.y} ${d.x},${d.y} ${u.x},${u.y}`),c.setAttributeNS(null,"fill",`url('#${p}')`),this.paths.push(c)}}},654:t=>{t.exports=class{constructor(t,e){this.colors=t,this.theme=this.colors[e]}getColor(t){return t&&(t=t.toUpperCase())in this.theme?this.theme[t]:this.theme.C}setTheme(t){this.colors.hasOwnProperty(t)&&(this.theme=this.colors[t])}}},537:t=>{t.exports={getChargeText:function(t){return console.log("in the utility version of getChargeText"),1===t?"+":2===t?"2+":-1===t?"-":-2===t?"2-":""}}},614:t=>{class e{constructor(t,e){0==arguments.length?(this.x=0,this.y=0):1==arguments.length?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}clone(){return new e(this.x,this.y)}toString(){return"("+this.x+","+this.y+")"}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}divide(t){return this.x/=t,this.y/=t,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}invert(){return this.x=-this.x,this.y=-this.y,this}angle(){return Math.atan2(this.y,this.x)}distance(t){return Math.sqrt((t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y))}distanceSq(t){return(t.x-this.x)*(t.x-this.x)+(t.y-this.y)*(t.y-this.y)}clockwise(t){let e=this.y*t.x,i=this.x*t.y;return e>i?-1:e===i?0:1}relativeClockwise(t,e){let i=(this.y-t.y)*(e.x-t.x),r=(this.x-t.x)*(e.y-t.y);return i>r?-1:i===r?0:1}rotate(t){let i=new e(0,0),r=Math.cos(t),n=Math.sin(t);return i.x=this.x*r-this.y*n,i.y=this.x*n+this.y*r,this.x=i.x,this.y=i.y,this}rotateAround(t,e){let i=Math.sin(t),r=Math.cos(t);this.x-=e.x,this.y-=e.y;let n=this.x*r-this.y*i,s=this.x*i+this.y*r;return this.x=n+e.x,this.y=s+e.y,this}rotateTo(t,i,r=0){this.x+=.001,this.y-=.001;let n=e.subtract(this,i),s=e.subtract(t,i),o=e.angle(s,n);return this.rotateAround(o+r,i),this}rotateAwayFrom(t,e,i){this.rotateAround(i,e);let r=this.distanceSq(t);this.rotateAround(-2*i,e),this.distanceSq(t)<r&&this.rotateAround(2*i,e)}getRotateAwayFromAngle(t,e,i){let r=this.clone();r.rotateAround(i,e);let n=r.distanceSq(t);return r.rotateAround(-2*i,e),r.distanceSq(t)<n?i:-i}getRotateTowardsAngle(t,e,i){let r=this.clone();r.rotateAround(i,e);let n=r.distanceSq(t);return r.rotateAround(-2*i,e),r.distanceSq(t)>n?i:-i}getRotateToAngle(t,i){let r=e.subtract(this,i),n=e.subtract(t,i),s=e.angle(n,r);return Number.isNaN(s)?0:s}isInPolygon(t){let e=!1;for(let i=0,r=t.length-1;i<t.length;r=i++)t[i].y>this.y!=t[r].y>this.y&&this.x<(t[r].x-t[i].x)*(this.y-t[i].y)/(t[r].y-t[i].y)+t[i].x&&(e=!e);return e}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSq(){return this.x*this.x+this.y*this.y}normalize(){return this.divide(this.length()),this}normalized(){return e.divideScalar(this,this.length())}whichSide(t,e){return(this.x-t.x)*(e.y-t.y)-(this.y-t.y)*(e.x-t.x)}sameSideAs(t,e,i){let r=this.whichSide(t,e),n=i.whichSide(t,e);return r<0&&n<0||0==r&&0==n||r>0&&n>0}static add(t,i){return new e(t.x+i.x,t.y+i.y)}static subtract(t,i){return new e(t.x-i.x,t.y-i.y)}static multiply(t,i){return new e(t.x*i.x,t.y*i.y)}static multiplyScalar(t,i){return new e(t.x,t.y).multiplyScalar(i)}static midpoint(t,i){return new e((t.x+i.x)/2,(t.y+i.y)/2)}static normals(t,i){let r=e.subtract(i,t);return[new e(-r.y,r.x),new e(r.y,-r.x)]}static units(t,i){let r=e.subtract(i,t);return[new e(-r.y,r.x).normalize(),new e(r.y,-r.x).normalize()]}static divide(t,i){return new e(t.x/i.x,t.y/i.y)}static divideScalar(t,i){return new e(t.x/i,t.y/i)}static dot(t,e){return t.x*e.x+t.y*e.y}static angle(t,i){let r=e.dot(t,i);return Math.acos(r/(t.length()*i.length()))}static threePointangle(t,i,r){let n=e.subtract(i,t),s=e.subtract(r,i),o=t.distance(i),a=i.distance(r);return Math.acos(e.dot(n,s)/(o*a))}static scalarProjection(t,i){let r=i.normalized();return e.dot(t,r)}static averageDirection(t){let i=new e(0,0);for(var r=0;r<t.length;r++){let e=t[r];i.add(e)}return i.normalize()}}t.exports=e},843:(t,e,i)=>{const r=i(474),n=i(348),s=i(614);i(427);class o{constructor(t,e=0,i=0){this.id=null,this.value=t,this.position=new s(e||0,i||0),this.previousPosition=new s(0,0),this.parentVertexId=null,this.children=Array(),this.spanningTreeChildren=Array(),this.edges=Array(),this.positioned=!1,this.angle=null,this.dir=1,this.neighbourCount=0,this.neighbours=Array(),this.neighbouringElements=Array(),this.forcePositioned=!1}setPosition(t,e){this.position.x=t,this.position.y=e}setPositionFromVector(t){this.position.x=t.x,this.position.y=t.y}addChild(t){this.children.push(t),this.neighbours.push(t),this.neighbourCount++}addRingbondChild(t,e){if(this.children.push(t),this.value.bracket){let i=1;0===this.id&&0===this.value.bracket.hcount&&(i=0),1===this.value.bracket.hcount&&0===e&&(i=2),1===this.value.bracket.hcount&&1===e&&(i=this.neighbours.length<3?2:3),null===this.value.bracket.hcount&&0===e&&(i=1),null===this.value.bracket.hcount&&1===e&&(i=this.neighbours.length<3?1:2),this.neighbours.splice(i,0,t)}else this.neighbours.push(t);this.neighbourCount++}setParentVertexId(t){this.neighbourCount++,this.parentVertexId=t,this.neighbours.push(t)}isTerminal(){return!!this.value.hasAttachedPseudoElements||null===this.parentVertexId&&this.children.length<2||0===this.children.length}clone(){let t=new o(this.value,this.position.x,this.position.y);return t.id=this.id,t.previousPosition=new s(this.previousPosition.x,this.previousPosition.y),t.parentVertexId=this.parentVertexId,t.children=n.clone(this.children),t.spanningTreeChildren=n.clone(this.spanningTreeChildren),t.edges=n.clone(this.edges),t.positioned=this.positioned,t.angle=this.angle,t.forcePositioned=this.forcePositioned,t}equals(t){return this.id===t.id}getAngle(t=null,e=!1){let i=null;return i=t?s.subtract(this.position,t):s.subtract(this.position,this.previousPosition),e?r.toDeg(i.angle()):i.angle()}getTextDirection(t){let e=this.getDrawnNeighbours(t),i=Array();for(let r=0;r<e.length;r++)i.push(this.getAngle(t[e[r]].position));let n=r.meanAngle(i),s=Math.PI/2;return n=Math.round(Math.round(n/s)*s),2===n?"down":-2===n?"up":0===n||-0===n?"right":3===n||-3===n?"left":"down"}getNeighbours(t=null){if(null===t)return this.neighbours.slice();let e=Array();for(let i=0;i<this.neighbours.length;i++)this.neighbours[i]!==t&&e.push(this.neighbours[i]);return e}getDrawnNeighbours(t){let e=Array();for(let i=0;i<this.neighbours.length;i++)t[this.neighbours[i]].value.isDrawn&&e.push(this.neighbours[i]);return e}getNeighbourCount(){return this.neighbourCount}getSpanningTreeNeighbours(t=null){let e=Array();for(let i=0;i<this.spanningTreeChildren.length;i++)void 0!==t&&t==this.spanningTreeChildren[i]||e.push(this.spanningTreeChildren[i]);return null!=this.parentVertexId&&(void 0!==t&&t==this.parentVertexId||e.push(this.parentVertexId)),e}getNextInRing(t,e,i){let r=this.getNeighbours();for(let s=0;s<r.length;s++)if(n.contains(t[r[s]].value.rings,{value:e})&&r[s]!=i)return r[s];return null}}t.exports=o}},e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={exports:{}};return t[r](n,n.exports,i),n.exports}i.d=(t,e)=>{for(var r in e)i.o(e,r)&&!i.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return(()=>{"use strict";i.r(r),i.d(r,{clean2d:()=>s});const{Parser:t,Drawer:e}=i(261),n=new e({debug:!1,atomVisualization:"default"});function s(e){let i=t.parse(e);n.initDraw(i,"light",!1),n.processGraph();let r=n.graph.vertices,s=Array();for(let t=0;t<r.length;t++){let e=r[t].position;s.push([e.x,e.y])}return s}})(),r})()}));